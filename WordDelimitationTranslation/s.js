!function(e){function t(t){for(var n,c,i=t[0],o=t[1],s=t[2],u=0,d=[];u<i.length;u++)c=i[u],Object.prototype.hasOwnProperty.call(l,c)&&l[c]&&d.push(l[c][0]),l[c]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(m&&m(t);d.length;)d.shift()();return r.push.apply(r,s||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,i=1;i<a.length;i++){var o=a[i];0!==l[o]&&(n=!1)}n&&(r.splice(t--,1),e=c(c.s=a[0]))}return e}var n={},l={16:0},r=[];function c(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=e,c.c=n,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(a,n,function(t){return e[t]}.bind(null,n));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window.webpackJsonp=window.webpackJsonp||[],o=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var m=o;r.push([649,0,2,4,8,17,1,3,6]),a()}({649:function(e,t,a){e.exports=a(658)},652:function(e,t,a){},658:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(24),c=a.n(r),i=a(36),o=a(81),s=a(290),m=a(59),u=a(73),d=a(15),E=a(411),p=a(680);function h(e){let t;return(null==e?void 0:e.vipEndTime)&&Object(E.a)(t=new Date(e.vipEndTime))?{isOpened:!0,text:"续费会员",endTime:Object(p.a)(t,"yyyy-MM-dd HH:mm:ss")}:{isOpened:!1,text:"开通会员"}}const b=l.a.createContext();var g=a(145);const v=m.T.create({maxToasts:2});var f=Object(n.forwardRef)((function(e,t){const[a,r]=Object(n.useState)(!1),[c,i]=Object(n.useState)("");Object(n.useImperativeHandle)(t,(()=>({async syncOptions(){let e;try{e=await Object(g.b)()}catch(e){return}"string"!=typeof e?(i(e.date),r(!0)):v.show({intent:"success",message:l.a.createElement(l.a.Fragment,null,"uploaded"===e&&"已将划词翻译设置上传到服务器。","not-modified"===e&&"划词翻译设置已经是最新的了，无需更新。","server-data-error"===e&&"服务器保存的划词翻译设置数据有误，请稍后重试。如果多次出现这种情况，请反馈给我。","covered"===e&&"已更新划词翻译设置。")})}})),[]);const o=new Date(c),s=Object(E.a)(o)?Object(p.a)(o,"yyyy-MM-dd HH:mm:ss"):"";return l.a.createElement(m.a,{isOpen:a,cancelButtonText:"否",confirmButtonText:"是",onCancel:async()=>{r(!1);try{await Object(g.c)(),v.show({intent:"success",message:"上传成功"})}catch(e){}},onConfirm:async()=>{let e;r(!1);try{e=await Object(g.a)(!0)}catch(e){return}v.show({intent:"success",message:l.a.createElement(l.a.Fragment,null,"no-data"===e&&"服务器没有保存过划词翻译设置，请先将本地设置上传。","not-modified"===e&&"划词翻译设置已经是最新的了，无需更新。","server-data-error"===e&&"服务器保存的划词翻译设置数据有误，请稍后重试。如果多次出现这种情况，请反馈给我。","covered"===e&&"已更新划词翻译设置。")})}},l.a.createElement(m.r,null,"是否要更新您的设置？"),l.a.createElement("p",null,"您于 ",s," ","同步过的设置跟您现在登录的划词翻译里的设置不一致，是否要用同步过的设置覆盖您现在的划词翻译设置？"),l.a.createElement("p",null,"如果选择否，划词翻译会将您现在的设置上传到服务器。"))})),y=a(414),k=a(90),x=a(3),O=a(10),w=a(170);const C="?notices"===window.location.search,j={...Object(k.a)(x.a,["noticesRead"]),...Object(k.a)(x.b,["noticesUnreadNum","noticesFiltered"])};function T(){const[e,t]=Object(O.a)(j),[a,r]=Object(n.useState)(!0),[c,i]=Object(n.useState)(C),o=[],s=[];e&&e.noticesFiltered.forEach((t=>{e.noticesRead.includes(t.id)?o.push(t):s.push(t)}));const u=a?s:o;return Object(n.useEffect)((()=>{browser.runtime.sendMessage({action:"refresh notices"})}),[]),l.a.createElement("div",{style:{position:"relative"}},l.a.createElement(m.H,{popoverClassName:"notice-popover",isOpen:c,position:"bottom",onClose:()=>{i(!1)},onClosed:()=>{r(!0)},content:l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}},l.a.createElement(m.r,{style:{marginBottom:0}},"通知"),l.a.createElement("a",{onClick:()=>r((e=>!e))},"显示",a?"已读":"未读")),l.a.createElement("div",{className:"notices-box"},u.map((a=>{const n=null==e?void 0:e.noticesRead.includes(a.id);return l.a.createElement(m.g,{key:a.id,style:{padding:10}},a.title&&l.a.createElement(m.t,null,a.title),l.a.createElement("p",{dangerouslySetInnerHTML:{__html:Object(w.sanitize)(a.text)}}),(a.link||!n)&&l.a.createElement("p",{className:"actions"},a.link&&l.a.createElement("a",{href:a.link,target:"_blank",rel:"noreferrer"},"查看详情"),!n&&l.a.createElement(l.a.Fragment,null,l.a.createElement("a",{style:{float:"right"},onClick:()=>{t((e=>{e.noticesRead.push(a.id)}))}},"标为已读"))))})),!u.length&&l.a.createElement(m.F,{icon:"notifications-updated",description:`没有${a?"未读":"已读"}通知`})))},l.a.createElement(m.d,{icon:"notifications",onClick:()=>i((e=>!e)),minimal:!0})),!!(null==e?void 0:e.noticesUnreadNum)&&l.a.createElement("div",{className:"notices-num",style:{position:"absolute",top:0,right:0}},null==e?void 0:e.noticesUnreadNum))}function S(e){return l.a.createElement(m.U,{interactionKind:"hover",position:"bottom",content:l.a.createElement("div",{style:{width:e.width||300}},e.children)},l.a.createElement("span",{style:{display:"inline-flex",height:12,width:12}},l.a.createElement(m.w,{icon:"help",iconSize:12,style:{cursor:"help"}})))}const N=Object(k.a)(x.a,["tipForeverVIPClosed"]);function P(){const[e,t]=Object(O.a)(N),{user:a,setUser:r,setShowVip:c,setShowLogin:i}=Object(n.useContext)(b),o=h(a),s=Object(n.useRef)(null),u=()=>{c(!0)},[E,p]=Object(y.a)((async()=>{await d.a.post("/logout"),r(null),browser.storage.local.remove(["optionsSyncAt","favoritesSyncAt","historiesSyncAt"])}),[]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(f,{ref:s}),l.a.createElement(m.B,{fixedToTop:!0},l.a.createElement(m.D,{align:"left"},l.a.createElement(m.E,null,"划词翻译"," ",l.a.createElement("span",{className:"bp3-text-small"},"v",browser.runtime.getManifest().version))),e&&!e.tipForeverVIPClosed&&l.a.createElement(m.D,{align:"left",style:{marginLeft:"65px"}},"划词翻译新增了永久会员。即日起至 2021 年 4 月 9 日，年费用户购买永久会员时可减免 30 元。",l.a.createElement(m.d,{onClick:()=>c(!0),small:!0},"开通会员"),l.a.createElement("a",{style:{marginLeft:"10px"},onClick:()=>{t({tipForeverVIPClosed:!0})}},"不再提醒")),l.a.createElement(m.D,{align:"right"},l.a.createElement(m.b,{minimal:!0,icon:"home",text:"官方网站",href:"https://hcfy.limingkai.cn/",target:"_blank",rel:"noreferrer"}),l.a.createElement(m.b,{icon:"git-repo",text:"更新日志",minimal:!0,href:"https://hcfy.limingkai.cn/docs/log",target:"_blank",rel:"noreferrer"}),l.a.createElement(m.b,{icon:"issue",minimal:!0,text:"反馈问题",href:"https://hcfy.limingkai.cn/docs/issues",target:"_blank",rel:"noreferrer"}),l.a.createElement(m.C,null),l.a.createElement(m.d,{icon:"refresh",text:"同步设置",onClick:()=>{var e;(null==a?void 0:a.vipActivated)?null===(e=s.current)||void 0===e||e.syncOptions():u()},style:{marginRight:"10px"}}),l.a.createElement(S,null,l.a.createElement("p",null,"开通会员后，划词翻译会在你每次更改设置后自动将设置上传到服务器。"),l.a.createElement("div",null,"另外，划词翻译会在后台每隔一小时检查设置是否有变更，你也可以点击“同步设置”按钮立刻进行一次检查。")),l.a.createElement(m.C,null),!a&&l.a.createElement(m.d,{icon:"log-in",minimal:!0,onClick:()=>{i(!0)},text:"登录"}),a&&l.a.createElement(l.a.Fragment,null,l.a.createElement(m.H,{interactionKind:"click",hoverOpenDelay:0,position:"bottom",onOpened:async()=>{const e=await d.a.get("/user-info");r(e.data)},content:l.a.createElement("div",{style:{padding:"10px"}},!o.isOpened&&l.a.createElement("p",null,"你还没有开通过会员。"),a.forever&&l.a.createElement("p",null,"会员永不过期。"),!a.forever&&a.vipActivated&&l.a.createElement("p",null,"会员将在 ",o.endTime," 到期。"),o.isOpened&&!a.vipActivated&&l.a.createElement("p",null,"会员已于 ",o.endTime," 过期。"),!a.forever&&l.a.createElement("p",{className:"bp3-popover-dismiss"},l.a.createElement(m.d,{fill:!0,text:o.text,onClick:u})),l.a.createElement("div",null,l.a.createElement(m.d,{fill:!0,icon:"log-out",loading:E.loading,onClick:p,text:"退出登录"})))},l.a.createElement(m.d,{minimal:!0,icon:a.vipActivated?"crown":"user",text:a.email,rightIcon:"caret-down"}))),l.a.createElement(T,null))))}function A(e){const[t,a]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{function t(){browser.permissions.contains(e).then(a)}return t(),browser.permissions.onAdded.addListener(t),browser.permissions.onRemoved.addListener(t),()=>{browser.permissions.onAdded.removeListener(t),browser.permissions.onRemoved.removeListener(t)}}),[e]),t}const L={permissions:["notifications"]};const F={origins:["<all_urls>"]};var R=a(675);var D=a(26);const I="chrome://extensions/?id="+browser.runtime.id;function K(){browser.tabs.create({url:I})}const B=l.a.createElement("a",{onClick:K},"划词翻译的详细信息页面"),M=D.b?"允许访问文件 URL":"允许访问文件网址";function V(){const e=Object(R.a)((()=>browser.extension.isAllowedFileSchemeAccess()),[]);return e.loading||e.value||e.error?null:l.a.createElement(m.f,{icon:"info-sign",title:"未允许划词翻译访问文件网址"},l.a.createElement("p",null,"你需要先前往",B,"勾选【",M,"】，划词翻译才能自动打开你拖放进浏览器的 PDF 文件。另外，当你勾选之后，你就可以将你电脑里的文件（例如"," ",l.a.createElement(m.i,null,".txt"),"、",l.a.createElement(m.i,null,".md"),"、",l.a.createElement(m.i,null,".html")," 或"," ",l.a.createElement(m.i,null,".png"),"）拖放进浏览器并使用划词翻译了。"),l.a.createElement(m.d,{intent:"primary",onClick:K},"去勾选"))}const _=D.b?"站点访问权限":"有权访问的网站";function U(e){return A(F)?null:l.a.createElement(m.f,{icon:"info-sign",title:"你更改了划词翻译的权限范围",style:e.style},l.a.createElement("p",null,"划词翻译检测到你更改了【",_,"】，这会导致划词翻译在部分甚至所有网站内都无法正常使用。如果这不是你所期望的，请前往",B,"，将【",_,"】改为【在所有网站上】。"),l.a.createElement("p",null,"如果你希望在部分网站内不启用网页划词，你可以点击浏览器地址栏右侧的划词翻译图标，展开【此页面已启用网页划词】，然后选择【在当前网站中禁用】。你还可以在下方的【划词设置】中勾选【禁用网页划词】，只通过快捷键、辅助键或右键菜单的方式显示翻译结果。"),l.a.createElement(m.d,{intent:"primary",onClick:K},"去修改"))}function q(){const e=Object(R.a)((()=>browser.extension.isAllowedIncognitoAccess()),[]);return e.loading||!e.value||e.error?null:l.a.createElement(m.f,{icon:"info-sign",title:"无痕模式下的限制"},l.a.createElement("p",null,"由于浏览器自身的安全限制，内置 PDF 阅读器无法在无痕窗口中使用，所以当你在无痕窗口中打开内置 PDF 阅读器时，划词翻译会自动改为在普通窗口中打开。"))}const H=Object(k.a)(x.a,["pdfAuto","notifySyncOptions"]);function z(){const{darkMode:e,setDarkMode:t}=Object(u.a)(),[a,r]=Object(O.a)(H),{hasNotifications:c,requestNotifications:i}={hasNotifications:A(L),requestNotifications:Object(n.useCallback)((()=>browser.permissions.request(L)),[])};return l.a.createElement("div",null,l.a.createElement(U,{style:{marginBottom:10}}),l.a.createElement(m.p,{id:"通用"},"通用"),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"深色模式"},"深色模式"),l.a.createElement(m.o,{inline:!0},l.a.createElement(m.J,{inline:!0,onChange:e=>{t(e.target.value)},selectedValue:e},l.a.createElement(m.I,{label:"开",value:"open"}),l.a.createElement(m.I,{label:"关",value:"close"}),l.a.createElement(m.I,{label:"跟随系统",value:"system"})))),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"PDF"},l.a.createElement("span",{style:{marginRight:10}},"PDF"),l.a.createElement(S,{width:400},l.a.createElement("p",null,"划词翻译内置了一个 PDF 阅读器，在这个阅读器中打开的 PDF 文件可以正常使用网页划词功能。"),l.a.createElement("p",null,"你可以使用以下几种方式打开内置的 PDF 阅读器："),l.a.createElement("ul",null,l.a.createElement("li",null,"点击浏览器地址栏右侧的划词翻译图标，在弹出来的弹窗中单击“内置 PDF 阅读器”按钮。"),l.a.createElement("li",null,"在网页中一个指向 PDF 文件的链接上单击鼠标右键，选择“在划词翻译中打开此 PDF”。"),l.a.createElement("li",null,"使用浏览器自带的 PDF 阅读器打开 PDF 文件后，鼠标右键单击页面，选择“在划词翻译中打开此 PDF”。")),l.a.createElement("p",null,"电脑里的 PDF 文件可以使用以下方式打开："),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("span",{style:void 0},"如果你启用了“自动打开 PDF”选项，那么只需要将 PDF 文件拖放到浏览器中即可。"),!1),l.a.createElement("li",null,"打开内置 PDF 阅读器，然后将 PDF 文件拖放进去。")))),l.a.createElement(m.o,{helperText:"开启后，在浏览器中打开 PDF 文件时会自动跳转到划词翻译的内置 PDF 阅读器。"},l.a.createElement(m.h,{label:"自动打开 PDF",checked:a?a.pdfAuto:H.pdfAuto,onChange:e=>{r({pdfAuto:e.target.checked})}})),l.a.createElement(V,null),l.a.createElement(q,null)),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"通知"},"通知"),!c&&l.a.createElement(m.f,{icon:"info-sign",title:"划词翻译需要获得你的授权才能显示通知"},l.a.createElement("p",null,"如果你希望划词翻译给你发送这些通知，请先允许划词翻译显示通知。"),l.a.createElement(m.d,{intent:"primary",onClick:i,text:"允许划词翻译显示通知"})),l.a.createElement(m.o,{inline:!0},l.a.createElement(m.h,{label:"在后台同步设置之后显示通知",checked:a?a.notifySyncOptions:H.notifySyncOptions,onChange:e=>{r({notifySyncOptions:e.target.checked})},disabled:!c}))))}var Q=a(116),W=a.n(Q);function J(){const[e,t]=Object(n.useState)(!1);return l.a.createElement(l.a.Fragment,null,l.a.createElement("a",{onClick:()=>{t(!0)}},"查看范例"),l.a.createElement(m.l,{isOpen:e,onClose:()=>{t(!1)},title:"范例",className:"example-dialog"},l.a.createElement("div",{className:"bp3-dialog-body"},l.a.createElement(m.v,{bordered:!0,condensed:!0,striped:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"规则"),l.a.createElement("th",null,"匹配的网址"),l.a.createElement("th",null,"不匹配的网址"))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"*/*"),l.a.createElement("p",null,"匹配任意网址。")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn"),l.a.createElement("p",null,"hcfy.limingkai.cn"),l.a.createElement("p",null,"baidu.com/search"),l.a.createElement("p",null,"jd.com/item.html")),l.a.createElement("td",null,l.a.createElement("p",null,"没有不匹配的网址"))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"*.limingkai.cn/*"),l.a.createElement("p",null,"匹配 ",l.a.createElement(m.i,null,"limingkai.cn")," 或者所有域名以"," ",l.a.createElement(m.i,null,".limingkai.cn")," 结尾的网址，网址可以有任意路径。")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn"),l.a.createElement("p",null,"hcfy.limingkai.cn"),l.a.createElement("p",null,"hcfy.limingkai.cn/path"),l.a.createElement("p",null,"aaa.hcfy.limingkai.cn")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.org ",l.a.createElement(m.Q,null,"域名不匹配")),l.a.createElement("p",null,"baidu.com ",l.a.createElement(m.Q,null,"域名不匹配")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn/*"),l.a.createElement("p",null,"匹配域名是 ",l.a.createElement(m.i,null,"limingkai.cn")," 的所有网址。")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn"),l.a.createElement("p",null,"limingkai.cn/path")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn ",l.a.createElement(m.Q,null,"域名不匹配")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn/"),l.a.createElement("p",null,"仅匹配 ",l.a.createElement(m.i,null,"limingkai.cn")," 这一个网址。")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn ",l.a.createElement(m.Q,null,"域名不匹配")),l.a.createElement("p",null,"limingkai.cn/path ",l.a.createElement(m.Q,null,"路径不匹配")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"*/path"),l.a.createElement("p",null,"匹配任意域名的网址，但路径部分只能是 ",l.a.createElement(m.i,null,"path"),"。")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/path"),l.a.createElement("p",null,"baidu.com/path")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/a ",l.a.createElement(m.Q,null,"路径不匹配")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"*/path/"),l.a.createElement("p",null,"匹配任意域名，但路径部分只能是 ",l.a.createElement(m.i,null,"path/"),"。跟上个例子相比，路径末尾多了一个 ",l.a.createElement(m.i,null,"/"),"。")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/path/"),l.a.createElement("p",null,"baidu.com/path/")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/path ",l.a.createElement(m.Q,null,"路径不匹配")),l.a.createElement("p",null,"hcfy.limingkai.cn/path/a ",l.a.createElement(m.Q,null,"路径不匹配")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/*path*"),l.a.createElement("p",null,"匹配 ",l.a.createElement(m.i,null,"hcfy.limingkai.cn")," 域名且路径中包含"," ",l.a.createElement(m.i,null,"path")," 的网址。")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/path"),l.a.createElement("p",null,"hcfy.limingkai.cn/abcpath"),l.a.createElement("p",null,"hcfy.limingkai.cn/abc/path"),l.a.createElement("p",null,"hcfy.limingkai.cn/abc/pathdef"),l.a.createElement("p",null,"hcfy.limingkai.cn/abc/path/def")),l.a.createElement("td",null,l.a.createElement("p",null,"hcfy.limingkai.cn/paXth ",l.a.createElement(m.Q,null,"路径不匹配")),l.a.createElement("p",null,"hcfy.limingkai.cn/pa/th ",l.a.createElement(m.Q,null,"路径不匹配")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn/*/path/*/"),l.a.createElement("p",null,"匹配 ",l.a.createElement(m.i,null,"limingkai.cn")," 域名且路径中包含"," ",l.a.createElement(m.i,null,"path"),"、",l.a.createElement(m.i,null,"path")," 左右有路径片段且以"," ",l.a.createElement(m.i,null,"/")," 结尾的网址。")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn/a/path/b/"),l.a.createElement("p",null,"limingkai.cn/a/b/path/c/d/")),l.a.createElement("td",null,l.a.createElement("p",null,"limingkai.cn/path/"," ",l.a.createElement(m.Q,null,l.a.createElement(m.i,null,"path")," 左右两边没有路径片段")),l.a.createElement("p",null,"limingkai.cn/a/path/"," ",l.a.createElement(m.Q,null,l.a.createElement(m.i,null,"path")," 右边没有路径片段")),l.a.createElement("p",null,"limingkai.cn/path/b/"," ",l.a.createElement(m.Q,null,l.a.createElement(m.i,null,"path")," 左边没有路径片段")))))))))}var G=a(32);const $={host:"",path:"/*"};function Y(e,t){switch(t.type){case"reset":return $;case"merge":return{...e,...t.data};default:throw new TypeError("不支持的 action type: "+JSON.stringify(t))}}function X(e){const{isOpen:t,setIsOpen:a,onSave:r,isExists:c,name:i}=e,[o,s]=Object(n.useState)(!1),u=Object(n.useRef)(null),d=()=>{a(!1),p({type:"reset"}),v("")},[E,p]=Object(n.useReducer)(Y,$),h=function(e){const t=e.host;return!!t&&("*"===t||!t.includes("*")||/^\*\.[^*]+$/.test(t))}(E),b=e=>{var t;const a=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text");if(a){const t=Object(G.a)(a);t&&(e.preventDefault(),p({type:"merge",data:t}))}},[g,v]=Object(n.useState)(""),f=h&&Object(G.d)(E,g),y=void 0!==f,k=f&&f.isHostMatch.matches&&f.isPathMatch.matches;return l.a.createElement(m.l,{canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:t,onClose:d,onOpening:()=>{var e;null===(e=u.current)||void 0===e||e.focus()},title:"新增"+i+"规则",className:"edit-rule-dialog"},l.a.createElement("div",{className:"bp3-dialog-body"},l.a.createElement(m.o,{label:"规则的格式"},l.a.createElement("div",{className:"bp3-form-helper-text"},"规则由“网站”和“页面”两个部分组成，在这两个部分中都可以使用通配符"," ",l.a.createElement(m.i,null,"*"),"。",l.a.createElement(m.V,null,l.a.createElement("li",null,"在“网站”中：",l.a.createElement(m.V,null,l.a.createElement("li",null,"可以有一个或 0 个通配符。如果有，则必须以通配符开头；"),l.a.createElement("li",null,"如果只填写了通配符，则表示匹配所有域名；"),l.a.createElement("li",null,"如果填写了以 ",l.a.createElement(m.i,null,"*.")," ","开头的域名，则表示匹配所有以这个域名结尾的域名；"),l.a.createElement("li",null,"你也可以不使用通配符来匹配单一的域名。"))),l.a.createElement("li",null,"在“页面”中：",l.a.createElement(m.V,null,l.a.createElement("li",null,"可以使用任意多个通配符，每个通配符表示匹配 0 个或多个任意字符；"),l.a.createElement("li",null,"页面必须以 ",l.a.createElement(m.i,null,"/")," 开头；"),l.a.createElement("li",null,"页面部分默认填写了 ",l.a.createElement(m.i,null,"/*"),"，表示匹配任意页面。")))),l.a.createElement(J,null))),l.a.createElement(m.s,null,"填写规则"),l.a.createElement(m.o,null,l.a.createElement(m.k,null,l.a.createElement(m.x,{placeholder:"域名",value:E.host,inputRef:u,onChange:e=>{p({type:"merge",data:{host:e.target.value.trim()}})},onPaste:b}),l.a.createElement(m.x,{placeholder:"路径",value:E.path,onChange:e=>{let t=e.target.value.trim();"/"!==t[0]&&(t="/"+t),p({type:"merge",data:{path:t}})},onPaste:b})),E.host&&!h&&l.a.createElement(m.f,{icon:null,intent:"warning"},"域名格式不正确")),l.a.createElement(m.s,null,"测试"," ",h&&l.a.createElement(m.i,{style:{fontWeight:"normal"}},Object(G.e)(E))),l.a.createElement(m.o,null,l.a.createElement(m.x,{value:g,onChange:e=>{v(e.target.value.trim())},placeholder:"你可以填写一个网址来测试是否跟规则匹配"}),g&&!y&&l.a.createElement(m.f,{icon:null,intent:"warning"},"网址格式不正确"),f&&y&&k&&l.a.createElement(m.f,{title:"匹配"}),f&&y&&!k&&l.a.createElement(m.f,{title:"不匹配"},f.isHostMatch.matches||l.a.createElement("p",null,"网址的域名 ",l.a.createElement(m.i,null,f.isHostMatch.urlHost)," ","不匹配规则 ",l.a.createElement(m.i,null,f.isHostMatch.ruleHost)),f.isPathMatch.matches||l.a.createElement("p",null,"网址的路径 ",l.a.createElement(m.i,null,f.isPathMatch.urlPath)," ","不匹配规则 ",l.a.createElement(m.i,null,f.isPathMatch.rulePath))))),l.a.createElement("div",{className:"bp3-dialog-footer"},l.a.createElement("div",{className:"bp3-dialog-footer-actions"},l.a.createElement(m.d,{onClick:d},"取消"),l.a.createElement(m.d,{intent:"primary",onClick:()=>{var e;h?c(E)?s(!0):(r(E),d()):null===(e=u.current)||void 0===e||e.focus()}},"保存"),l.a.createElement(m.a,{confirmButtonText:"我知道了",isOpen:o,onConfirm:()=>{s(!1)}},"规则 ",l.a.createElement(m.i,null,Object(G.e)(E))," 已经有了，无需重复添加。"))))}function Z(e){const{rules:t,setRules:a,name:r,disabled:c}=e,[i,o]=Object(n.useState)(!1),s=Object(n.useRef)();const[u,d]=Object(n.useState)(!1),E=()=>{d(!1),s.current=void 0};return l.a.createElement("div",{className:"domain-rules"},l.a.createElement("div",{className:"header"},l.a.createElement(m.t,null,r),l.a.createElement(m.d,{disabled:c,icon:"add",onClick:()=>{o(!0)},minimal:!0})),l.a.createElement("div",{className:"table-box"},l.a.createElement(m.v,{bordered:!0,striped:!0,condensed:!0},l.a.createElement("tbody",null,t.length?t.map((e=>{const t=Object(G.e)(e);return l.a.createElement("tr",{key:t},l.a.createElement("td",null,t),l.a.createElement("td",null,l.a.createElement(m.d,{disabled:c,minimal:!0,icon:"delete",onClick:()=>function(e){s.current=e,d(!0)}(e)})))})):l.a.createElement("tr",null,l.a.createElement("td",{colSpan:2},l.a.createElement(m.F,{title:"没有规则",description:"黑名单"===r?l.a.createElement(l.a.Fragment,null,"命中黑名单的网址会禁用网页划词"):l.a.createElement(l.a.Fragment,null,"命中白名单的网址会始终启用网页划词"),action:l.a.createElement(m.d,{disabled:c,onClick:()=>{o(!0)},intent:"primary"},"添加一条规则")})))))),l.a.createElement(m.a,{icon:"trash",intent:"danger",isOpen:u,confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:()=>{if(s.current){const e=t.indexOf(s.current);if(e>=0){const n=[...t];n.splice(e,1),a(n)}}E()},onCancel:E},"确定要从",r,"中删除"," ",l.a.createElement(m.i,null,s.current?Object(G.e)(s.current):"这条规则")," ","吗？"),l.a.createElement(X,{isOpen:i,setIsOpen:o,onSave:e=>{const n=[...t];n.push(e),a(n)},isExists:e=>t.some((t=>W()(t,e))),name:r}))}var ee=a(20);function te(){browser.tabs.create({url:"chrome://extensions/shortcuts"})}const ae={_execute_browser_action:"打开划词翻译的扩展弹出窗口翻译剪切板内的文本。",page:"开启 / 关闭网页全文翻译。",screenshot:"开启截图翻译。",translate:"翻译网页中选中的文本。",translateWithPopup:"在独立翻译窗口中显示当前网页中选中文本的翻译结果。",switchWeb:"切换【禁用网页划词】选项。",panel:l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:void 0},"这是一个全局快捷键，你可以在浏览器以外的地方使用此快捷键来打开独立窗口翻译剪切板内的文本。在修改此快捷键时，请确保作用域为“全局”。"),!1)};function ne(){var e;const t=Object(R.a)((()=>browser.commands.getAll()),[]);return l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"快捷键"},"快捷键"),l.a.createElement("p",{className:"bp3-text-muted"},l.a.createElement(l.a.Fragment,null,"请前往",l.a.createElement("a",{onClick:te},"键盘快捷键页面"),"修改这些快捷键。",l.a.createElement("a",{href:"https://hcfy.limingkai.cn/docs/faq#edit-shortcut-key",target:"_blank",rel:"noreferrer"},"修改后没有生效？")),!1),l.a.createElement(m.v,{condensed:!0,striped:!0,bordered:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",{style:{width:160}},"名称"),l.a.createElement("th",{style:{width:170}},"快捷键"),l.a.createElement("th",null,"简介"))),l.a.createElement("tbody",null,null===(e=t.value)||void 0===e?void 0:e.map((e=>{const t=e.name;return t?l.a.createElement("tr",{key:t},l.a.createElement("td",null,e.description||"激活该扩展程序"),l.a.createElement("td",null,e.shortcut?function(e){const t=e.split("+"),a=t.length-1;return l.a.createElement(l.a.Fragment,null,t.map(((e,t)=>{const n=t===a;return l.a.createElement(l.a.Fragment,{key:e},l.a.createElement("kbd",null,e),!n&&"+")})))}(e.shortcut):"未设置"),l.a.createElement("td",null,ae[t])):null})))))}function le(){const e=Object(i.f)();return l.a.createElement(m.U,{interactionKind:"hover",hoverCloseDelay:300,content:l.a.createElement(l.a.Fragment,null,"此选项支持",l.a.createElement("a",{onClick:()=>e.push("/#快捷键")},"快捷键"),"。")},l.a.createElement(m.Q,{style:{fontWeight:"normal"},minimal:!0},"快捷键"))}const re=Object(k.a)(x.a,["button","buttonAutoClose","disableInTextarea","domainBlackList","domainWhiteList","textList","placement","pin","pinPos","pinIgnoreDomainList","modifierKeys","modifierKeyPressedAction","modifierKeyTranslate","modifierKeyLink"]),ce={host:"*",path:"/*"},ie=[{label:"上",value:"top"},{label:"上左",value:"top-end"},{label:"上右",value:"top-start"},{label:"下",value:"bottom"},{label:"下左",value:"bottom-end"},{label:"下右",value:"bottom-start"},{label:"左",value:"left"},{label:"左上",value:"left-end"},{label:"左下",value:"left-start"},{label:"右",value:"right"},{label:"右上",value:"right-end"},{label:"右下",value:"right-start"}];function oe(){const[e,t]=Object(n.useState)(!1),[a,r]=Object(O.a)(re),c=e=>{r((t=>{const a=t.modifierKeys.indexOf(e);a>=0?t.modifierKeys.splice(a,1):t.modifierKeys.push(e)}))},i=!(null==a?void 0:a.modifierKeys.length),o=null==a?void 0:a.domainBlackList,s=null==a?void 0:a.domainWhiteList,u=Object(n.useMemo)((()=>!!o&&o.some((e=>e.host===ce.host&&e.path===ce.path))),[o]),[d,E]=Object(n.useState)(""),p=Object(n.useMemo)((()=>Object(G.a)(d)),[d]),{matchedRule:h,whiteListMatched:b,blackListMatched:g}=Object(n.useMemo)((()=>p&&o&&s?Object(G.b)(p,o,s):{matchedRule:void 0,whiteListMatched:void 0,blackListMatched:void 0}),[o,s,p]),v=!!a;return Object(n.useEffect)((()=>{if(v){const e=decodeURI(window.location.hash.slice(1));e&&(window.location.hash="",window.location.hash=e)}}),[v]),a?l.a.createElement("div",{id:"selection"},l.a.createElement(m.p,{id:"网页划词"},"网页划词"),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"使用方式"},"使用方式"),l.a.createElement(m.f,{intent:"primary",title:"支持的使用方式"},l.a.createElement("p",null,"默认情况下，划词翻译会在划词后显示一个翻译按钮，点击按钮后会弹出翻译结果。"),l.a.createElement("p",null,"如果你觉得每次划词都显示按钮对你造成了干扰，你可以勾选下面“划词设置”中的“禁用网页划词”选项。你也可以在点击浏览器右上角的扩展图标后出现的弹窗中对特定网站或页面禁用 / 启用网页划词。"),l.a.createElement("p",null,"无论是否启用了网页划词，你都可以使用以下方式获取翻译结果："),l.a.createElement(m.V,null,l.a.createElement("li",null,"使用辅助键（需要先至少选择一个辅助键）：",l.a.createElement(m.V,null,l.a.createElement("li",null,"在按住全部辅助键不放的情况下，可以选择”划词后直接弹出翻译窗口”或”开启鼠标悬浮取词“。"),l.a.createElement("li",null,"松开辅助键后，翻译页面中选中的文本。（需启用）"),l.a.createElement("li",null,"按住全部辅助键不放时，让页面中的链接可被选中。（需启用）"))),l.a.createElement("li",null,"使用快捷键。划词翻译支持很多快捷键，请前往左侧菜单中的【快捷键】查看详情。"),l.a.createElement("li",null,"使用右键菜单：",l.a.createElement(m.V,null,l.a.createElement("li",null,"划词后从右键菜单中选择“翻译选中的文本”会直接弹出翻译结果。在浏览器的内置页面中只能使用右键菜单翻译的方式。")))))),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"划词设置"},"划词设置"),l.a.createElement(m.o,{helperText:"如果你只想用辅助键、快捷键和右键菜单的方式获取翻译结果，你可以勾选此选项，避免每次划词后都显示翻译按钮。"},l.a.createElement(m.h,{labelElement:l.a.createElement(l.a.Fragment,null,"禁用网页划词 ",l.a.createElement(le,null)),checked:u,onChange:e=>{const t=e.target.checked;r((e=>{const a=e.domainBlackList,n=a.findIndex((e=>e.host===ce.host&&e.path===ce.path));t&&n>=0||!t&&n<0||(t?a.unshift(ce):a.splice(n,1))}))}})),l.a.createElement(m.o,{label:"翻译按钮"},l.a.createElement(m.h,{disabled:u,label:"划词后先显示翻译按钮",checked:a.button,onChange:e=>{r({button:e.target.checked})}}),l.a.createElement("p",{className:"bp3-text-muted bp3-text-small"},"勾选后，划词之后会先显示翻译按钮，点击按钮后才会弹出翻译结果；如果不勾选，那么划词后会直接弹出翻译结果。"),l.a.createElement(m.h,{disabled:u||!a.button,label:"自动隐藏",checked:a.buttonAutoClose,onChange:e=>{r({buttonAutoClose:e.target.checked})}}),l.a.createElement("p",{className:"bp3-text-muted bp3-text-small"},"勾选后，翻译按钮会在 2 秒后自动隐藏。"),l.a.createElement(m.h,{label:"在文本框内划词后不触发翻译",checked:a.disableInTextarea,onChange:e=>{r({disableInTextarea:e.target.checked})}}),l.a.createElement("p",{className:"bp3-text-muted bp3-text-small"},"勾选后，当你在文本框内划词时不会显示翻译按钮，也不会在固定模式时触发翻译。")),l.a.createElement(m.o,{label:"网址筛选"},l.a.createElement("p",{className:"bp3-text-small bp3-text-muted"},"划词翻译支持用黑 / 白名单规则控制在某些网址下是否启用网页划词。禁用了网页划词的页面在用鼠标划词后不会显示翻译按钮或翻译窗口，而且扩展图标会变为灰色，但你仍然可以使用辅助键、快捷键和右键菜单获取翻译结果。"),l.a.createElement(m.o,{helperText:"勾选后，在固定模式下，无论当前页面是否处于黑 / 白名单中，划词后都会立刻显示翻译结果。"},l.a.createElement(m.h,{label:"固定模式下忽略黑 / 白名单规则",checked:a?a.pinIgnoreDomainList:re.pinIgnoreDomainList,onChange:()=>{r((e=>{e.pinIgnoreDomainList=!e.pinIgnoreDomainList}))}})),l.a.createElement("p",null,l.a.createElement(m.d,{onClick:()=>{t((e=>!e))}},e?"隐藏":"显示","黑 / 白名单规则")),l.a.createElement("p",{className:"bp3-text-small bp3-text-muted"},"通常情况下，你不需要手动修改黑 / 白名单规则，因为你可以在点击扩展图标后出现的弹窗中便捷的禁用 / 启用网页划词。"),l.a.createElement(m.j,{isOpen:e,keepChildrenMounted:!0},l.a.createElement("div",{className:"list"},l.a.createElement(Z,{disabled:u,rules:a.domainBlackList,setRules:e=>{r({domainBlackList:e})},name:"黑名单"}),l.a.createElement(Z,{disabled:u,rules:a.domainWhiteList,setRules:e=>{r({domainWhiteList:e})},name:"白名单"})),l.a.createElement(m.t,null,"测试黑 / 白名单"),l.a.createElement(m.o,null,l.a.createElement(m.x,{value:d,onChange:e=>{E(e.target.value.trim())},placeholder:"你可以填写一个网址来测试是否命中了黑名单或白名单"}),d&&!p&&l.a.createElement(m.f,{intent:"warning"},"网址格式不正确"),h&&l.a.createElement(m.f,null,g&&"没有命中白名单且","命中了",l.a.createElement("b",null,b?"白":"黑","名单"),"中的"," ",l.a.createElement(m.i,null,Object(G.e)(h))," 规则，此网址下会",l.a.createElement("b",null,b?"开启":"关闭"),"网页划词功能。"),p&&!g&&!b&&l.a.createElement(m.f,null,"既没有命中白名单，也没有命中黑名单，此网址下会开启网页划词功能。")))),l.a.createElement(m.o,{label:"文本筛选"},a.textList.map((e=>l.a.createElement("div",{key:e.name},l.a.createElement(m.h,{disabled:u,label:e.name,checked:e.enabled,onChange:()=>{return t=e,void r((e=>{const a=e.textList,n=Object(ee.d)(a).indexOf(t);if(n>=0){const e=a[n];e.enabled=!e.enabled}}));var t}}),l.a.createElement("p",{className:"bp3-text-small bp3-text-muted"},e.description))))),l.a.createElement(m.o,{helperText:"弹窗会先尝试朝这个方向显示，如果空间不够，它会自动调整方向确保处于可视区域内。"},l.a.createElement(m.J,{label:"弹窗显示方向",inline:!0,onChange:e=>{r({placement:e.target.value})},selectedValue:a.placement,className:"placement-group"},ie.map((e=>l.a.createElement(m.I,{value:e.value,label:e.label,key:e.value})))))),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"辅助键"},"辅助键"),l.a.createElement(m.o,{label:"选择辅助键",helperText:l.a.createElement(l.a.Fragment,null,"当选中的辅助键",l.a.createElement("b",null,l.a.createElement("i",null,"全部")),"按下不放时会触发下面的操作。")},l.a.createElement(m.h,{inline:!0,labelElement:l.a.createElement(l.a.Fragment,null,l.a.createElement("kbd",null,"Ctrl"),"/",l.a.createElement("kbd",null,"⌘")),checked:a.modifierKeys.includes("ctrl"),onChange:()=>{c("ctrl")}}),l.a.createElement(m.h,{inline:!0,labelElement:l.a.createElement(l.a.Fragment,null,l.a.createElement("kbd",null,"Alt"),"/",l.a.createElement("kbd",null,"⌥")),checked:a.modifierKeys.includes("alt"),onChange:()=>{c("alt")}}),l.a.createElement(m.h,{inline:!0,labelElement:l.a.createElement("kbd",null,"Shift"),checked:a.modifierKeys.includes("shift"),onChange:()=>{c("shift")}})),l.a.createElement(m.o,null,l.a.createElement(m.J,{inline:!0,disabled:i,label:"在按住辅助键不放的情况下：",selectedValue:a.modifierKeyPressedAction,onChange:e=>{r({modifierKeyPressedAction:e.currentTarget.value})}},l.a.createElement(m.I,{label:"不选择",value:""}),l.a.createElement(m.I,{label:"划词后直接弹出翻译结果",value:"selection"}),l.a.createElement(m.I,{label:"开启鼠标悬浮取词",value:"hover"}),1===a.modifierKeys.length&&"ctrl"===a.modifierKeys[0]&&"selection"===a.modifierKeyPressedAction&&l.a.createElement(m.f,{intent:"warning"},"单独使用",l.a.createElement("kbd",null,"Ctrl"),"/",l.a.createElement("kbd",null,"⌘"),"作为辅助键时，选择“划词后直接弹出翻译结果”可能会导致你用",l.a.createElement("kbd",null,"Ctrl"),"/",l.a.createElement("kbd",null,"⌘"),"+",l.a.createElement("kbd",null,"C"),"复制文本时误触翻译。如果你遇到了这个问题，请替换或添加其它辅助键。")),l.a.createElement(m.h,{disabled:i,label:"松开辅助键后，翻译页面中选中的文本",checked:a.modifierKeyTranslate,onChange:e=>{r({modifierKeyTranslate:e.target.checked})}}),1===a.modifierKeys.length&&"ctrl"===a.modifierKeys[0]&&a.modifierKeyTranslate&&l.a.createElement(m.f,{intent:"warning"},"单独使用",l.a.createElement("kbd",null,"Ctrl"),"/",l.a.createElement("kbd",null,"⌘"),"作为辅助键时，启用此选项会导致你在文本框中选中文本后，用",l.a.createElement("kbd",null,"Ctrl"),"/",l.a.createElement("kbd",null,"⌘"),"+",l.a.createElement("kbd",null,"Space"),"切换输入法时误触翻译。如果你想避免这个问题，请替换或添加其它辅助键。"),l.a.createElement(m.h,{disabled:i,label:"按住辅助键不放时，让页面中的链接可被选中",checked:a.modifierKeyLink,onChange:e=>{r({modifierKeyLink:e.target.checked})}}))),l.a.createElement(ne,null)):null}var se=a(132);function me(e){const{setShowVip:t,user:a}=Object(n.useContext)(b),r=e.forever?"永久":"";return(e.forever?null==a?void 0:a.forever:null==a?void 0:a.vipActivated)?l.a.createElement(l.a.Fragment,null,"你已经是",r,"会员了，可以使用此功能。",!(null==a?void 0:a.forever)&&l.a.createElement("a",{onClick:()=>t(!0)},"续费会员")):l.a.createElement(l.a.Fragment,null,"这是一个",r,"会员功能，请在",l.a.createElement("a",{onClick:()=>t(!0)},"成为",r,"会员"),"后使用。")}const ue=l.a.createElement(m.U,{interactionKind:"hover",hoverCloseDelay:300,content:l.a.createElement(me,null)},l.a.createElement(m.Q,{style:{top:"3px"},icon:"crown"},"会员功能")),de=l.a.createElement(m.U,{interactionKind:"hover",hoverCloseDelay:300,content:l.a.createElement(me,{forever:!0})},l.a.createElement(m.Q,{style:{top:"3px",fontWeight:"normal"},icon:"crown"},"永久会员功能"));var Ee=a(234);const pe=Object(k.a)(x.a,["width","destination","secondDestination","showTextArea","autoClipboard","autoPlay","autoCopy","recentUseLangFrom","recentUseLangTo","pin","pinPos","panelPos","panelSize","sourceTransformNoBr","sourceTransformNCaml","sourceTransformNoComment","panelCustomStyle","textAreaAuto"]),he=l.a.createElement(m.Q,{htmlTitle:"此选项可以直接在翻译面板的快捷设置中调整。",minimal:!0},"快捷选项");function be(){const{user:e}=Object(n.useContext)(b),[t,a]=Object(O.a)(pe);return l.a.createElement("div",null,l.a.createElement(m.p,{id:"翻译面板"},"翻译面板"),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"通用设置"},"通用设置"),l.a.createElement(m.o,{label:"字体和按钮大小",labelInfo:he},l.a.createElement(Ee.a,{value:(null==t?void 0:t.panelSize)||pe.panelSize,onChange:e=>{a({panelSize:e})}})),l.a.createElement(m.o,{label:"目标语种",labelInfo:he},"优先翻译为"," ",l.a.createElement(se.a,{lang:t?t.destination:pe.destination,setLang:e=>{a({destination:e})}}),"，若源语种也是",t?t.destination:pe.destination,"，则翻译为"," ",l.a.createElement(se.a,{lang:t?t.secondDestination:pe.secondDestination,setLang:e=>{a({secondDestination:e})}})),l.a.createElement(m.o,{helperText:"点击扩展图标或使用全局快捷键打开独立窗口时，自动读取剪切板的内容并翻译"},l.a.createElement(m.N,{labelElement:l.a.createElement(l.a.Fragment,null,"自动读取剪切板 ",he),checked:t?t.autoClipboard:pe.autoClipboard,onChange:e=>{a({autoClipboard:e.target.checked})}})),l.a.createElement(m.o,{helperText:"翻译后如果第一个翻译源可以朗读，则自动朗读被翻译的文本。为避免朗读时间过长，如果被翻译的文本超过了 30 个字符则不会朗读。"},l.a.createElement(m.N,{labelElement:l.a.createElement(l.a.Fragment,null,"自动朗读 ",he),checked:t?t.autoPlay:pe.autoPlay,onChange:e=>{a({autoPlay:e.target.checked})}})),l.a.createElement(m.o,{helperText:"翻译后如果第一个翻译源有翻译结果，则自动将翻译结果复制进剪切板。"},l.a.createElement(m.N,{labelElement:l.a.createElement(l.a.Fragment,null,"自动复制 ",he," ",ue),disabled:!(null==e?void 0:e.vipActivated),checked:t?t.autoCopy:pe.autoCopy,onChange:e=>{a({autoCopy:e.target.checked})}})),l.a.createElement(m.o,{label:"翻译源",helperText:"此设置项的位置移动到了左侧菜单的“翻译源” - “启用翻译源”。"}),l.a.createElement(m.o,{className:"inline-form-group-label",label:l.a.createElement(l.a.Fragment,null,"源文本处理",ue),helperText:l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,"在翻译之前对源文本进行处理以提高翻译准确度。"),l.a.createElement(m.V,null,l.a.createElement("li",null,"去掉换行符：部分网站如"," ",l.a.createElement("a",{href:"https://www.rfc-editor.org/rfc/rfc6633.txt",target:"_blank",rel:"noreferrer"},"RFCs 文档站"),"在文本中自行加入了换行符，这导致翻译结果不是按照完整的句子翻译的，勾选此选项即可去除源文本里的所有换行符。"),l.a.createElement("li",null,"去掉双斜线：部分代码使用双斜线 // 作为代码注释，勾选此选项即可去掉文本中的所有双斜线。如果同时勾选了“去掉换行符”，则可以正常翻译多行注释。"),l.a.createElement("li",null,"转换驼峰式或下划线式词组：部分网站如 GitHub 里查看代码时，有很多驼峰式或下划线式的词组如“someData”、“click_by_someone”，勾选此选项后，如果源文本是驼峰式或下划线式词组，则会转换成“some data”、“click by someone”这类形式。")),l.a.createElement("div",null,"如果你希望划词翻译添加其它处理方式，可以",l.a.createElement("a",{href:"https://hcfy.limingkai.cn/docs/issues",target:"_blank",rel:"noreferrer"},"反馈给我"),"。"))},l.a.createElement(m.h,{label:"去掉换行符",inline:!0,disabled:!(null==e?void 0:e.vipActivated),checked:t?t.sourceTransformNoBr:pe.sourceTransformNoBr,onChange:e=>{a({sourceTransformNoBr:e.target.checked})}}),l.a.createElement(m.h,{label:"去掉双斜线（//）",inline:!0,disabled:!(null==e?void 0:e.vipActivated),checked:t?t.sourceTransformNoComment:pe.sourceTransformNoComment,onChange:e=>{a({sourceTransformNoComment:e.target.checked})}}),l.a.createElement(m.h,{label:"转换驼峰式和下划线式词组",inline:!0,disabled:!(null==e?void 0:e.vipActivated),checked:t?t.sourceTransformNCaml:pe.sourceTransformNCaml,onChange:e=>{a({sourceTransformNCaml:e.target.checked})}})),l.a.createElement(m.o,{label:"快捷链接",helperText:"快捷链接已移动到左侧菜单的“翻译源” - “快捷链接”中。"}),l.a.createElement(m.o,{label:"自定义面板样式",helperText:l.a.createElement(l.a.Fragment,null,"使用"," ",l.a.createElement("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS",target:"_blank",rel:"noreferrer"},"CSS")," ","自定义面板样式。",l.a.createElement("a",{href:"https://github.com/lmk123/crx-selection-translate/discussions/950",target:"_blank",rel:"noreferrer"},"分享你的或查看其他人的自定义样式"))},l.a.createElement(m.S,{growVertically:!0,large:!0,fill:!0,onChange:e=>{a({panelCustomStyle:e.target.value})},value:(t?t.panelCustomStyle:pe.panelCustomStyle)||"#translate-panel {\n  /* 浅色模式下的面板样式 */\n}\n.bp3-dark #translate-panel {\n  /* 深色模式下的面板样式 */\n}",placeholder:"#translate-panel {\n  /* 浅色模式下的面板样式 */\n}\n.bp3-dark #translate-panel {\n  /* 深色模式下的面板样式 */\n}"}))),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"网页划词面板"},"网页划词面板"),l.a.createElement(m.o,{helperText:"是否要在网页划词面板中显示文本框。在独立翻译窗口和扩展图标窗口中将始终显示文本框。"},l.a.createElement(m.h,{labelElement:l.a.createElement(l.a.Fragment,null,"显示文本框 ",he),checked:t?t.showTextArea:pe.showTextArea,onChange:e=>{a({showTextArea:e.target.checked})}})),l.a.createElement(m.o,{helperText:"勾选后，你在文本框内停止输入超过 1 秒后会自动翻译文本框中的文本。如果你经常在文本框内输入大段的文本，建议不要启用此选项，因为这会导致输入过程中触发多次翻译，造成字符数的浪费。"},l.a.createElement(m.h,{labelElement:l.a.createElement(l.a.Fragment,null,"自动翻译文本框"),checked:t?t.textAreaAuto:pe.textAreaAuto,onChange:e=>{a({textAreaAuto:e.target.checked})}})),l.a.createElement(m.o,{label:"面板宽度",helperText:"拖动面板的左右边缘可以调整面板的宽度。"},l.a.createElement(m.x,{disabled:!0,value:t?t.width+"px":pe.width+"px"})),l.a.createElement(m.o,{helperText:"固定模式下，面板不会跟随浏览器滚动，且划词后会立刻显示翻译结果。点击面板左上角的图钉可以切换固定状态。"},"是否固定：",(t?t.pin:pe.pin)?"是":"否"),t&&t.pinPos&&l.a.createElement(m.o,{label:"面板位置",helperText:"面板距离浏览器左上角的距离。拖动面板可以改变面板的位置。"},"左边距：",t.pinPos.x,"px",l.a.createElement("br",null),"上边距：",t.pinPos.y,"px")),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"独立翻译窗口"},"独立翻译窗口"),t&&l.a.createElement(m.o,{label:"位置和宽高",helperText:"每当你对独立窗口进行调整后都会自动保存位置和宽高。"},l.a.createElement("p",null,"上边距：",t.panelPos.top,"px 左边距：",t.panelPos.left,"px",l.a.createElement("br",null),"宽度：",t.panelPos.width,"px 高度：",t.panelPos.height,"px"))))}Object(k.a)(x.a,["quickLinks"]);const ge={name:"",link:"",menu:!1,panel:!1},ve=[{name:"谷歌搜索",link:"https://www.google.com/search?q=%s",menu:!0,panel:!0},{name:"百度搜索",link:"https://www.baidu.com/s?wd=%s",menu:!0,panel:!0},{name:"维基百科",link:"https://zh.wikipedia.org/w/index.php?search=%s",menu:!0,panel:!0},{name:"剑桥词典",link:"https://dictionary.cambridge.org/dictionary/english-chinese-simplified/%s",menu:!0,panel:!0}],fe=m.T.create({position:"bottom",maxToasts:1});function ye(e){var t;const{user:a,setShowVip:r}=Object(n.useContext)(b),{options:c,setOptions:i}=e,[o,s]=Object(n.useState)(!1),[u,d]=Object(n.useState)(-1),[E,p]=Object(n.useState)(!1),[h,g]=Object(n.useState)(-1),[v,f]=Object(n.useState)(ge),[y,k]=Object(n.useState)(!1),x=Object(n.useRef)(null);return l.a.createElement(m.o,{helperText:l.a.createElement(l.a.Fragment,null,"快捷链接是基于你所划选的文本生成的链接。",l.a.createElement("a",{style:{marginRight:10},onClick:()=>k((e=>!e))},"查看教程"),l.a.createElement("a",{href:"https://github.com/lmk123/crx-selection-translate/discussions/945",target:"_blank",rel:"noreferrer"},"分享你的或查看其他人的快捷链接"))},l.a.createElement(m.l,{isOpen:y,title:"如何配置快捷链接",onClose:()=>k(!1)},l.a.createElement("div",{className:"bp3-dialog-body"},l.a.createElement("p",null,"以百度搜索为例："),l.a.createElement(m.G,null,l.a.createElement("li",null,"打开",l.a.createElement("a",{href:"https://www.baidu.com",target:"_blank",rel:"noreferrer"},"百度搜索"),"并搜索 ",l.a.createElement(m.i,null,"test"),"，百度搜索会跳转到一个新的网址：",l.a.createElement("a",{href:"https://www.baidu.com/s?wd=test&ie=utf-8&tn=baiduhome_pg",target:"_blank",rel:"noreferrer"},"https://www.baidu.com/s?wd=test&ie=utf-8&tn=baiduhome_pg")),l.a.createElement("li",null,"这个网址中包含我们刚才搜索的关键词 ",l.a.createElement(m.i,null,"test"),"，我们只需要将 ",l.a.createElement(m.i,null,"test")," 替换成 ",l.a.createElement(m.i,null,"%s")," ","填写进快捷链接即可，也就是"," ",l.a.createElement(m.i,null,"https://www.baidu.com/s?wd=%s&ie=utf-8&tn=baiduhome_pg")),l.a.createElement("li",null,"最后，这个网址中其实有很多不需要的参数，例如"," ",l.a.createElement(m.i,null,"&ie=utf-8&tn=baiduhome_pg"),"，也可以将它们去掉之后再填进划词翻译中。")),l.a.createElement("div",null,"配置好了之后，假设你在网页上划选了“划词翻译”，那么百度搜索的快捷链接就会指向"," ",l.a.createElement("a",{href:"https://www.baidu.com/s?wd=%E5%88%92%E8%AF%8D%E7%BF%BB%E8%AF%91",target:"_blank",rel:"noreferrer"},"https://www.baidu.com/s?wd=划词翻译"),"，点击之后就能看到用百度搜索“划词翻译”的搜索结果。"))),l.a.createElement(m.a,{isOpen:u>=0,cancelButtonText:"取消",confirmButtonText:"确定",intent:"danger",icon:"trash",onClose:e=>{var t;e&&(t=u,i((e=>{e.quickLinks.splice(t,1)}))),d(-1)}},"确定要删除“",null===(t=null==c?void 0:c.quickLinks[u])||void 0===t?void 0:t.name,"”吗？"),l.a.createElement(m.l,{isOpen:o,title:(E?"修改":"新增")+"快捷链接",onClose:()=>{s(!1),f(ge)},onOpened:()=>{var e;null===(e=x.current)||void 0===e||e.focus()}},l.a.createElement("form",{onSubmit:e=>{var t,a,n,l,r,o,m,u;if(e.preventDefault(),E){if(null==c?void 0:c.quickLinks.find(((e,t)=>e.name===v.name&&t!==h)))return null===(t=x.current)||void 0===t||t.setCustomValidity("快捷链接的名称不能重复。"),void(null===(a=x.current)||void 0===a||a.reportValidity());null===(n=x.current)||void 0===n||n.setCustomValidity(""),m=v,u=h,i((e=>{e.quickLinks.splice(u,1,m)}))}else{if(null==c?void 0:c.quickLinks.find((e=>e.name===v.name)))return null===(l=x.current)||void 0===l||l.setCustomValidity("快捷链接的名称不能重复。"),void(null===(r=x.current)||void 0===r||r.reportValidity());null===(o=x.current)||void 0===o||o.setCustomValidity(""),(e=>{i((t=>{t.quickLinks.push(e)}))})(v)}s(!1),f(ge)}},l.a.createElement("div",{className:"bp3-dialog-body"},l.a.createElement("p",null,"示例：",ve.map((e=>l.a.createElement("a",{style:{marginRight:"5px"},key:e.name,onClick:()=>f(e)},e.name)))),l.a.createElement(m.o,{label:"名称："},l.a.createElement(m.x,{required:!0,inputRef:x,value:v.name,onChange:e=>{f(Object(ee.b)((t=>{t.name=e.target.value})))}})),l.a.createElement(m.o,{label:"链接：",helperText:"可以在链接中使用“%s”表示划选的文本。"},l.a.createElement(m.x,{required:!0,type:"url",value:v.link,onChange:e=>{f(Object(ee.b)((t=>{t.link=e.target.value})))}})),l.a.createElement(m.o,{label:"显示在：",inline:!0},l.a.createElement(m.h,{inline:!0,label:"右键菜单",checked:v.menu,onChange:()=>{f(Object(ee.b)((e=>{e.menu=!e.menu})))}}),l.a.createElement(m.h,{inline:!0,label:"翻译面板",checked:v.panel,onChange:()=>{f(Object(ee.b)((e=>{e.panel=!e.panel})))}}))),l.a.createElement("div",{className:"bp3-dialog-footer"},l.a.createElement("div",{className:"bp3-dialog-footer-actions"},l.a.createElement(m.d,{onClick:()=>{s(!1),f(ge)}},"取消"),l.a.createElement(m.d,{type:"submit",intent:"primary"},"确定"))))),l.a.createElement(m.v,{className:"quick-links-table",condensed:!0,striped:!0,bordered:!0,style:{width:"100%"}},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"名称"),l.a.createElement("th",null,"在翻译面板中显示"),l.a.createElement("th",null,"在右键菜单中显示"),l.a.createElement("th",null,"操作"))),l.a.createElement("tbody",null,!(null==c?void 0:c.quickLinks.length)&&l.a.createElement("tr",null,l.a.createElement("td",{colSpan:4},l.a.createElement(m.F,{title:"没有快捷链接",description:"你还没有添加任何快捷链接，点击下方按钮即可添加。"}))),null==c?void 0:c.quickLinks.map(((e,t)=>l.a.createElement("tr",{key:t},l.a.createElement("td",null,l.a.createElement("a",{href:e.link.replace("%s",encodeURIComponent("划词翻译")),target:"_blank",rel:"noreferrer"},e.name)),l.a.createElement("td",null,e.panel?"是":"否"),l.a.createElement("td",null,e.menu?"是":"否"),l.a.createElement("td",null,l.a.createElement(m.d,{minimal:!0,icon:"edit",onClick:()=>{c&&(!(null==a?void 0:a.vipActivated)&&c.quickLinks.length>5?fe.show({timeout:0,intent:"primary",action:{text:"开通会员",onClick:()=>{r(!0)}},message:"非会员用户最多添加 5 个快捷链接，在修改快捷链接之前，请先将快捷链接删除至 5 个。成为会员即可解除此限制。"}):(p(!0),g(t),f(e),s(!0)))}},"修改"),l.a.createElement(m.d,{minimal:!0,icon:"delete",onClick:()=>d(t)},"删除"))))),l.a.createElement("tr",null,l.a.createElement("td",{colSpan:4,style:{textAlign:"center"}},l.a.createElement(m.d,{onClick:()=>{c&&(!(null==a?void 0:a.vipActivated)&&c.quickLinks.length>=5?fe.show({timeout:0,intent:"primary",action:{text:"开通会员",onClick:()=>{r(!0)}},message:"非会员用户最多添加 5 个快捷链接。成为会员即可解除此限制。"}):(p(!1),s(!0)))}},"新增快捷链接"))))))}const ke=l.a.createElement(l.a.Fragment,null,[{label:"电商 - 商品标题",value:"title"},{label:"电商 - 商品描述",value:"description"},{label:"电商 - 买卖家沟通",value:"communication"},{label:"医疗",value:"medical"},{label:"社交",value:"social"},{label:"金融",value:"finance"}].map((e=>l.a.createElement("option",{key:e.value,value:e.value},e.label))));function xe(e){return l.a.createElement(m.u,{value:e.value||"",onChange:t=>{e.onChange(t.currentTarget.value||null)}},l.a.createElement("option",{value:""},"请选择"),ke)}const Oe=l.a.createElement(l.a.Fragment,null,[{label:"电子科技",value:"electronics"},{label:"金融财经",value:"finance"},{label:"水利机械",value:"mechanics"},{label:"生物医药",value:"medicine"},{label:"网络文学",value:"novel"}].map((e=>l.a.createElement("option",{key:e.value,value:e.value},e.label)))),we=["electronics","mechanics","novel"];function Ce(e){return l.a.createElement(m.u,{value:e.value||"",onChange:t=>{e.onChange(t.currentTarget.value||null)}},l.a.createElement("option",{value:""},"请选择"),Oe)}var je=a(235),Te=a(236),Se=a(243);function Ne(e){const{selected:t,onChange:a}=e;return l.a.createElement(Te.a,{items:Se.a,selected:t,onChange:a,labelKey:"name",valueKey:"id",itemRenderer:(e,t,a,n,r)=>l.a.createElement("div",{key:a},l.a.createElement(m.h,{inline:!0,labelElement:t,checked:n,onChange:e=>{r(e.target.checked)}}),l.a.createElement(m.b,{minimal:!0,small:!0,icon:l.a.createElement(m.w,{icon:"share",iconSize:12}),target:"_blank",href:e.name}))})}var Pe=a(72);const Ae=Object(k.a)(x.a,["selectedAPIs","selectedExternalLinks","googleRegion","quickLinks","customAPI","customAPINames","aliDomain","baiduDomain"]);function Le(){const[e,t]=Object(O.a)(Ae),[a,r]=Object(n.useState)(!1);return l.a.createElement("div",null,l.a.createElement(m.p,{id:"翻译源"},"翻译源"),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"启用翻译源"},"启用翻译源"),l.a.createElement(m.o,{label:"直接显示结果",labelInfo:he,helperText:"这些翻译源的结果会直接在翻译面板上显示出来。"},l.a.createElement(je.a,{selectedAPIs:(null==e?void 0:e.selectedAPIs)||[],onChange:e=>{t({selectedAPIs:e})}}),(null==e?void 0:e.selectedAPIs.includes("ALiOfficialDomain"))&&l.a.createElement("div",null,"请选择阿里翻译（专业版）的专业领域：",l.a.createElement(xe,{value:e.aliDomain,onChange:e=>{t({aliDomain:e})}})),(null==e?void 0:e.selectedAPIs.includes("BaiDuDomain"))&&l.a.createElement("div",null,"请选择百度翻译（专业版）的专业领域：",l.a.createElement(Ce,{value:e.baiduDomain,onChange:e=>{t({baiduDomain:e})}}),e.baiduDomain&&we.includes(e.baiduDomain)&&l.a.createElement("p",{className:"bp3-text-small bp3-text-muted"},"百度翻译（专业版）的电子科技、水利机械、网络文学三个领域仅支持从中文翻译为英文，如果将英文翻译为中文，会默认显示普通的百度翻译结果。"))),l.a.createElement(m.o,{label:"显示顺序",helperText:"翻译源的显示顺序跟你勾选的顺序一致。如果你想完全重新排序，可以取消勾选所有翻译源后重新勾选。"},!(null==e?void 0:e.selectedAPIs.length)&&"-",null==e?void 0:e.selectedAPIs.map(((e,t,a)=>{const n=Pe.a.find((t=>t.id===e)),r=t===a.length-1;return n?l.a.createElement("span",{key:n.id,style:r?void 0:{marginRight:3}},n.name,!r&&" >"):null}))),l.a.createElement(m.o,{label:"跳转链接",helperText:"这些翻译源暂时以跳转链接的形式提供，未来可能会逐步替换成直接显示的形式。"},l.a.createElement("div",{className:"external-translators"},l.a.createElement(Ne,{selected:(null==e?void 0:e.selectedExternalLinks)||[],onChange:e=>{t({selectedExternalLinks:e})}})))),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"快捷链接"},"快捷链接"),l.a.createElement(ye,{options:e,setOptions:t})),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"自定义翻译源"},"自定义翻译源 ",de),l.a.createElement(m.o,{label:"接口地址",helperText:l.a.createElement(l.a.Fragment,null,"划词翻译会从这个接口地址获取自定义翻译源的翻译结果。",l.a.createElement("a",{href:"https://hcfy.limingkai.cn/docs/services/custom-api",target:"_blank",rel:"noreferrer"},"查看示例"))},l.a.createElement(m.x,{value:e?e.customAPI:Ae.customAPI,onChange:e=>{t({customAPI:e.target.value})}})),l.a.createElement(m.o,{label:"翻译源名称",helperText:"按下回车键添加翻译源名称，可输入多个。成为永久会员后，这些翻译源会显示在翻译面板中，并从上面配置的接口获取翻译结果。"},l.a.createElement(m.R,{values:e?e.customAPINames:Ae.customAPINames,onChange:e=>{t({customAPINames:e})}})),l.a.createElement(m.d,{loading:a,onClick:()=>{const t=null==e?void 0:e.customAPINames[0];t?(r(!0),browser.runtime.sendMessage({action:"translate",data:{apiCode:t,text:"划词翻译自定义翻译源测试"}}).then((e=>{r(!1),e.error?window.alert("接口报错了。错误消息：\n"+JSON.stringify(e.error,null,2)):window.alert("调用成功，返回的数据为：\n"+JSON.stringify(e,null,2))}),(e=>{r(!1),window.alert("接口报错了。错误消息："+(null==e?void 0:e.message))}))):window.alert("请至少添加一个翻译源名称")}},"测试")),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"谷歌翻译"},"谷歌翻译"),l.a.createElement(m.o,{label:"地区",inline:!0},l.a.createElement(m.J,{inline:!0,selectedValue:e?e.googleRegion:Ae.googleRegion,onChange:e=>{t({googleRegion:e.currentTarget.value})}},l.a.createElement(m.I,{label:"国内（.cn）",value:"cn"}),l.a.createElement(m.I,{label:"国外（.com）",value:"com"})))))}var Fe=a(89);const Re={...Object(k.a)(x.a,["audioVolume","audioRate","systemTTS","systemTTSVoice","systemTTSAccent"]),...Object(k.a)(x.b,["user"])};function De(){const[e,t]=Object(O.a)(Re),a=Object(R.a)(Fe.e),{setShowVip:r}=Object(n.useContext)(b);return e?l.a.createElement("div",null,l.a.createElement(m.p,{id:"语音朗读"},"语音朗读"),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"音量和语速"},"音量和语速"),l.a.createElement(m.o,{label:"音量"},l.a.createElement(m.L,{min:0,max:100,stepSize:1,labelStepSize:20,value:e.audioVolume,onChange:e=>{t({audioVolume:e})}})),l.a.createElement(m.o,{label:"语速"},l.a.createElement(m.L,{min:0,max:4,stepSize:.01,labelStepSize:1,value:e.audioRate,onChange:e=>{t({audioRate:e})}}))),l.a.createElement(m.g,null,l.a.createElement(m.r,{id:"系统语音"},l.a.createElement("span",{style:{marginRight:10}},"系统语音"),l.a.createElement(S,null,l.a.createElement("p",null,"系统语音是由你的浏览器和操作系统提供的语音，划词翻译支持使用系统语音来朗读文本。"),l.a.createElement("p",null,"系统语音有两种类型：本地语音和网络语音。本地语音在电脑没有联网时也能使用；网络语音需要电脑联网才能使用，网络不好的情况下可能无法发声。",D.a&&l.a.createElement("b",null,"由谷歌提供的网络语音需要能连接外网才可使用。")),l.a.createElement("div",null,"建议在 Microsoft Edge 浏览器或 macOS 操作系统上使用系统语音设置，因为它们提供的语音最丰富多样。"))),l.a.createElement(m.o,{label:"何时使用系统语音",helperText:"部分操作系统或浏览器在使用系统语音后可能会出现浏览器崩溃、视频音画不同步或杂音问题，如果你遇到了这些问题，请选择“不使用系统语音”。"},l.a.createElement(m.J,{selectedValue:e.systemTTS,onChange:e=>{t({systemTTS:e.currentTarget.value})}},l.a.createElement(m.I,{label:"先使用翻译源自己的语音朗读，如果翻译源无法朗读，再使用系统语音",value:"aid"}),l.a.createElement(m.I,{label:"始终使用系统语音朗读",value:"prior"}),l.a.createElement(m.I,{label:"不使用系统语音",value:"none"}))),a.loading?l.a.createElement("div",null,"正在读取系统语音列表，请稍候……"):a.error?l.a.createElement("div",null,a.error.message):a.value&&l.a.createElement(m.o,null,l.a.createElement(m.o,{className:"inline-form-group-label",label:l.a.createElement(l.a.Fragment,null,"选择口音",ue),helperText:Object.keys(a.value.multipleLang).length?"你的浏览器对以上语言支持多种口音，你可以选择一个你喜欢的口音来朗读这些语言。":"你的浏览器没有提供多个口音，因此无法选择。"},Object.keys(a.value.multipleLang).map((n=>{var c,i;const o=null===(c=a.value)||void 0===c?void 0:c.multipleLang[n];return l.a.createElement("div",{key:n},Fe.a[n]||n,"：",l.a.createElement(m.u,{value:(null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.vipActivated)?e.systemTTSAccent[n]:n,onChange:a=>{var l;(null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.vipActivated)?t((e=>{const t=a.target.value;t?e.systemTTSAccent[n]=t:delete e.systemTTSAccent[n]})):r(!0)}},l.a.createElement("option",{value:""},"自动"),o.map((e=>l.a.createElement("option",{key:e,value:e},Fe.c[e]||e)))))}))),l.a.createElement(m.o,{className:"inline-form-group-label",label:l.a.createElement(l.a.Fragment,null,"选择系统语音",ue),helperText:Object.keys(a.value.voicesGroup).length?"你的浏览器对以上语言支持多个系统语音，你可以选择一个你喜欢的系统语音用来朗读这些语言。":"你的浏览器没有提供多个系统语音，因此无法选择。"},Object.keys(a.value.voicesGroup).map((n=>{var c;const i=a.value.voicesGroup[n];return l.a.createElement("div",{key:n},Fe.c[n]||n,"：",l.a.createElement(m.u,{value:(null===(c=null==e?void 0:e.user)||void 0===c?void 0:c.vipActivated)?e.systemTTSVoice[n]:n,onChange:a=>{var l;(null===(l=null==e?void 0:e.user)||void 0===l?void 0:l.vipActivated)?t((e=>{const t=a.target.value;t?e.systemTTSVoice[n]=t:delete e.systemTTSVoice[n]})):r(!0)}},l.a.createElement("option",{value:""},"自动"),i.map((e=>l.a.createElement("option",{key:e.name,value:e.name},e.name+(e.localService?" - 本地语音":" - 网络语音"))))))}))),l.a.createElement(m.H,{interactionKind:"hover",content:l.a.createElement("div",{style:{padding:10,maxHeight:400,overflowY:"auto",overscrollBehavior:"contain"}},l.a.createElement(m.v,{bordered:!0,condensed:!0,striped:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"语言"),l.a.createElement("th",null,"系统语音名称"),l.a.createElement("th",null,"类型"))),l.a.createElement("tbody",null,a.value.singleList.map((e=>{var t;const n=null===(t=a.value)||void 0===t?void 0:t.singleVoiceMap[e];return l.a.createElement("tr",{key:e},l.a.createElement("td",null,Fe.c[e]||e),l.a.createElement("td",null,null==n?void 0:n.name),l.a.createElement("td",null,(null==n?void 0:n.localService)?"本地语音":"网络语音"))})))))},l.a.createElement("a",null,"查看你的浏览器和操作系统支持的其它语音"))))):null}var Ie=a(683);const Ke=[{divider:!0,text:"通用"},"深色模式","PDF","通知",{divider:!0,text:"网页划词"},"使用方式","划词设置","辅助键","快捷键",{divider:!0,text:"翻译面板"},"通用设置","网页划词面板","独立翻译窗口",{divider:!0,text:"翻译源"},"启用翻译源","快捷链接","自定义翻译源","谷歌翻译",{divider:!0,text:"语音朗读"},"音量和语速","系统语音"];function Be(){const e=Object(i.f)(),t=Object(i.g)(),{height:a}=Object(Ie.a)(),r=Object(n.useMemo)((()=>decodeURIComponent(t.hash.slice(1))),[t.hash]);return Object(n.useEffect)((()=>{window.setTimeout((()=>{const e=document.getElementById(r);e&&window.scrollBy({top:e.getBoundingClientRect().top-85})}))}),[r]),l.a.createElement("div",{className:"wrapper"},l.a.createElement("div",{className:"nav"},l.a.createElement(m.g,null,l.a.createElement(m.y,{style:{maxHeight:a-70,overflowY:"auto"}},Ke.map((t=>"string"==typeof t?l.a.createElement(m.A,{text:t,onClick:()=>{e.push("/#"+t)},active:r===t,key:t}):l.a.createElement(m.z,{title:t.text,key:t.text})))))),l.a.createElement("div",{className:"content"},l.a.createElement(z,null),l.a.createElement(oe,null),l.a.createElement(be,null),l.a.createElement(Le,null),l.a.createElement(De,null)))}const Me=D.b?"https://microsoftedge.microsoft.com/addons/detail/oikmahiipjniocckomdccmplodldodja":"https://chrome.google.com/webstore/detail/ikhdkkncnoglghljlkmcimlnlhkeamad";function Ve(){return l.a.createElement("div",{style:{margin:"15px"}},l.a.createElement(m.p,{id:"关于"},"关于划词翻译"),l.a.createElement("p",null,"划词翻译是一款简单好用的翻译软件，支持桌面端的 Chrome、Edge 和 Firefox 浏览器。"),l.a.createElement("p",null,"划词翻译由我个人创建于 2013 年，并持续维护至今。",l.a.createElement("a",{target:"_blank",rel:"noreferrer",href:"https://hcfy.limingkai.cn/docs/histroy"},"查看划词翻译大事记")),l.a.createElement("p",null,"如果你觉得划词翻译很好用，请给它一个五星好评！"),l.a.createElement("p",null,l.a.createElement(m.b,{text:"给划词翻译一个五星好评",href:Me,target:"_blank",rel:"noreferrer"})))}var _e=a(676),Ue=a(685),qe=a(677),He=a(291),ze=a(682),Qe=a(175),We=a(640);const Je={end:!0,rows:[],loading:!1,selectedRows:[],searchText:"",latestDate:void 0},Ge=(e,t)=>Object(ee.b)(e,(e=>{switch(t.type){case"reset":return Je;case"set":return void t.cb(e);case"set latestDate":const a=Object(We.a)(e.rows);return a?void(e.latestDate=a.date):void(e.latestDate=void 0);case"append data":if(e.end=t.data.length<100,!t.data.length)return;return void e.rows.push(...t.data);case"switch-check":const n=e.selectedRows.indexOf(t.id);return void(n>=0?e.selectedRows.splice(n,1):e.selectedRows.push(t.id))}}));function $e(e,t,a){const[l,r]=Object(n.useState)(0),[c,i]=Object(n.useReducer)(Ge,Je),o=Object(n.useCallback)((()=>{i({type:"set latestDate"})}),[]);Object(n.useEffect)((()=>{if(c.end)return;const e=()=>{document.documentElement.scrollTop+window.innerHeight===document.documentElement.scrollHeight&&o()};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}}),[o,c.end]),Object(n.useEffect)((()=>{let t=!1;return i({type:"set",cb(e){e.loading=!0}}),e(100,c.latestDate,c.searchText).then((e=>{t||(i({type:"set",cb(e){e.loading=!1}}),i({type:"append data",data:e}))})),()=>{t=!0}}),[c.searchText,c.latestDate,l,e]);return Object(n.useEffect)((()=>{t&&a.pull(t.vipActivated).then((e=>{e&&(i({type:"reset"}),r((e=>e+1)))}))}),[a,t]),{tableData:c,queryNextPage:o,deleteSelected:()=>a.deleteById(c.selectedRows,!!t&&t.vipActivated).then((()=>{i({type:"set",cb(e){e.rows=e.rows.filter((e=>!c.selectedRows.includes(e.id))),e.selectedRows=[]}})})),clearData:()=>a.deleteAll(!!t).then((()=>{i({type:"set",cb(e){e.selectedRows=[],e.end=!0,e.rows=[],e.latestDate=void 0,e.searchText=""}})})),setSearchText:e=>{i({type:"set",cb(t){e!==t.searchText&&(t.end=!0,t.rows=[],t.searchText=e.trim(),t.latestDate=void 0)}})},cancelSelected:()=>{i({type:"set",cb(e){e.selectedRows=[]}})},switchCheck:e=>{i({type:"switch-check",id:e})}}}const Ye=Object(k.a)(x.a,["historyEnabled","historySyncEnabled"]);function Xe(e){const t=new Date(e);return Object(E.a)(t)?Object(p.a)(t,"b K:mm",{locale:ze.a}):""}function Ze(e){return new URL(e).hostname}function et(){const[e,t]=Object(O.a)(Ye),a=e||Ye,{user:r,setShowVip:c}=Object(n.useContext)(b),[i,o]=Object(n.useState)(!1),[s,u]=Object(n.useState)(!1),{tableData:d,queryNextPage:h,deleteSelected:g,clearData:v,setSearchText:f,cancelSelected:y,switchCheck:k}=$e(Qe.b,r,Qe.a),x=Object(n.useMemo)((()=>{const e=[];let t,a;return d.rows.forEach((n=>{!t||Object(qe.a)(t,n.date)?(t=Object(He.a)(n.date),a=[n],e.push({date:t,items:a})):a.push(n)})),e}),[d.rows]);return l.a.createElement("div",{id:"history-records"},l.a.createElement(m.a,{cancelButtonText:"取消",confirmButtonText:"确定",intent:"danger",isOpen:i,icon:"trash",onClose:e=>{e&&g(),o(!1)}},l.a.createElement("p",null,"确定要删除这些记录吗？")),l.a.createElement(m.a,{cancelButtonText:"取消",confirmButtonText:"确定",icon:"trash",intent:"danger",isOpen:s,onClose:e=>{e&&v(),u(!1)}},l.a.createElement("p",null,"确定要清空历史记录吗？")),l.a.createElement("div",{className:"actions"},l.a.createElement("div",{className:"actions-left"},l.a.createElement(m.x,{className:"search-input",placeholder:"搜索历史记录",rightElement:d.searchText?l.a.createElement(m.d,{icon:"cross",minimal:!0,onClick:()=>{f("")}}):void 0,value:d.searchText,onChange:e=>{const t=e.target.value;f(t)}}),d.selectedRows.length?l.a.createElement(l.a.Fragment,null,l.a.createElement(m.d,{text:`删除选中的记录（${d.selectedRows.length}）`,intent:"primary",style:{marginLeft:"10px"},onClick:()=>{o(!0)}}),l.a.createElement(m.d,{text:"取消选择",style:{margin:"0 10px"},onClick:y}),l.a.createElement(m.d,{intent:"danger",text:"清空历史记录",onClick:()=>{u(!0)}})):void 0),l.a.createElement("div",{className:"actions-right"},!(null==r?void 0:r.vipActivated)&&l.a.createElement("a",{style:{marginRight:15},onClick:()=>c(!0)},"将历史记录同步到云端"),l.a.createElement(m.h,{label:"启用历史记录",inline:!0,checked:a.historyEnabled,onChange:e=>{t({historyEnabled:e.target.checked})}}))),l.a.createElement("div",{className:"actions-bg",style:{height:"60px"}}),l.a.createElement("div",{style:{padding:"0 15px 15px 15px"}},x.map((({date:e,items:t})=>l.a.createElement(m.g,{key:e.getTime()},l.a.createElement(m.q,null,function(e){if(!Object(E.a)(e))return"";let t="";return Object(_e.a)(e)?t="今天 - ":Object(Ue.a)(e)&&(t="昨天 - "),t+Object(p.a)(e,"yyyy 年 M 月 d 日 EEEE",{locale:ze.a})}(e)),t.map((e=>{return l.a.createElement("p",{key:e.id,className:"history-item"},l.a.createElement("span",{className:"date"},l.a.createElement(m.h,{checked:d.selectedRows.includes(e.id),labelElement:l.a.createElement("span",{className:"bp3-text-muted"},Xe(e.date)),onChange:()=>{k(e.id)}})),l.a.createElement("span",{className:"text"},e.text),(t=e.url).startsWith("chrome-extension://")||t.startsWith("moz-extension://")?l.a.createElement("span",{className:"bp3-text-small bp3-text-muted hostname",onClick:()=>{f("划词翻译")}},e.title):l.a.createElement(l.a.Fragment,null,l.a.createElement("img",{src:e.favicon,width:"12px",height:"12px",alt:""}),l.a.createElement("a",{className:"bp3-text-overflow-ellipsis",href:e.url,target:"_blank",rel:"noreferrer",title:e.title||e.url},e.title||e.url),l.a.createElement("span",{className:"bp3-text-small bp3-text-muted hostname",onClick:()=>{const t=Ze(e.url);f(t)}},Ze(e.url))));var t}))))),!d.loading&&!d.end&&l.a.createElement(m.d,{onClick:h,text:"加载更多"}),d.loading&&l.a.createElement(m.M,null),!d.loading&&!d.rows.length&&l.a.createElement(m.F,{icon:"blank",title:d.searchText?"没有搜索结果":"无历史记录",description:a.historyEnabled?"":"若要记录翻译历史，请勾选上方的“启用历史记录”。"})))}var tt=a(86),at=a(4),nt=a.n(at),lt=a(198),rt=a(105),ct=a(144),it=a(159);const ot={GoogleWeb:ct.a,BingDictWeb:it.a},st=["GoogleWeb","BingDictWeb"];function mt(e){const{item:t,selected:a,switchSelected:r}=e,[c,i]=Object(n.useState)({});return Object(n.useEffect)((()=>{t.results&&i(t.results)}),[t]),Object(n.useEffect)((()=>{if(t.results)return;const e=t.dir;if(e){const a={};Promise.all(st.map((n=>(async(e,t,a,n)=>{const l=ot[t];try{return null==l?void 0:l.translate(e,[n],a)}catch(e){}})(t.text,n,e.from,e.to).then((e=>{e&&(a[n]=e)}))))).then((()=>{i(a),tt.a.table.update(t.id,{results:a})}))}}),[t]),l.a.createElement(m.g,{className:nt()("favorite-item",{active:a}),interactive:!0,onClick:()=>{r(t.id)}},l.a.createElement(m.r,null,t.text),Object.keys(c).map((e=>l.a.createElement(lt.a,{key:e,apiId:e,result:{loading:!1,result:c[e]||null},queryResult:rt.a,wordClickable:!1}))))}const ut=Object(k.a)(x.a,["favoritesEnabled"]);function dt(){const[e,t]=Object(O.a)(ut),a=e||ut,{user:r,setShowVip:c}=Object(n.useContext)(b),[i,o]=Object(n.useState)(!1),[s,u]=Object(n.useState)(!1),{tableData:d,queryNextPage:E,deleteSelected:p,clearData:h,setSearchText:g,cancelSelected:v,switchCheck:f}=$e(tt.d,r,tt.a);return l.a.createElement("div",{id:"favorites"},l.a.createElement(m.a,{cancelButtonText:"取消",confirmButtonText:"确定",intent:"danger",isOpen:i,icon:"trash",onClose:e=>{e&&p(),o(!1)}},l.a.createElement("p",null,"确定要删除吗？")),l.a.createElement(m.a,{cancelButtonText:"取消",confirmButtonText:"确定",icon:"trash",intent:"danger",isOpen:s,onClose:e=>{e&&h(),u(!1)}},l.a.createElement("p",null,"确定要清空收藏夹吗？")),l.a.createElement("div",{className:"actions"},l.a.createElement("div",{className:"actions-left"},l.a.createElement(m.x,{className:"search-input",placeholder:"搜索收藏夹",rightElement:d.searchText?l.a.createElement(m.d,{icon:"cross",minimal:!0,onClick:()=>{g("")}}):void 0,value:d.searchText,onChange:e=>{const t=e.target.value;g(t)}}),d.selectedRows.length?l.a.createElement(l.a.Fragment,null,l.a.createElement(m.d,{text:`删除选中的收藏（${d.selectedRows.length}）`,intent:"primary",style:{marginLeft:"10px"},onClick:()=>{o(!0)}}),l.a.createElement(m.d,{style:{margin:"0 10px"},text:"取消选择",onClick:v}),l.a.createElement(m.d,{intent:"danger",text:"清空收藏夹",onClick:()=>{u(!0)}})):void 0),l.a.createElement("div",{className:"actions-right"},!(null==r?void 0:r.vipActivated)&&l.a.createElement("a",{style:{marginRight:15},onClick:()=>c(!0)},"将收藏夹同步到云端"),l.a.createElement(m.h,{label:"启用收藏功能",inline:!0,checked:a.favoritesEnabled,onChange:e=>{t({favoritesEnabled:e.target.checked})}}))),l.a.createElement("div",{className:"actions-bg",style:{height:"60px"}}),l.a.createElement("div",{className:"favorite-list"},d.rows.map((e=>l.a.createElement(mt,{key:e.id,item:e,selected:d.selectedRows.includes(e.id),switchSelected:f})))),!d.loading&&!d.end&&l.a.createElement(m.d,{onClick:E,text:"加载更多"}),d.loading&&l.a.createElement(m.M,null),!d.loading&&!d.rows.length&&l.a.createElement(m.F,{icon:"blank",title:d.searchText?"没有搜索结果":"无收藏",description:a.favoritesEnabled?"如果你不需要收藏功能，可以取消勾选上方的“启用收藏功能”，这样翻译面板上的收藏图标就会消失。":""}))}var Et=a(61);let pt=!1;const ht=m.T.create({maxToasts:2}),bt={401:"您的登录状态已失效，请重新登录。",500:"服务器内部产生了一个错误，请稍后重试。"};const gt=m.T.create(),vt={email:"",pwd:"",vk:""};var ft=Object(n.forwardRef)((function(e,t){const{onLogin:a,openType:r,tip:c}=e,[i,o]=Object(n.useState)(!1),[s,u]=Object(n.useState)(!1),E=Object(n.useRef)(null),p=Object(n.useRef)(null),[h,b]=Object(n.useState)(null),g="login"===r?"登录":"注册";Object(n.useEffect)((()=>{h&&h.focus()}),[h]);const[v,f]=Object(n.useState)(vt),[x,O]=Object(y.a)((async()=>{try{await d.a.post("/sendEmail",Object(k.a)(v,"email"))}catch(e){return void(Object(d.c)(e)&&gt.show({intent:"warning",message:e.message}))}gt.show({intent:"success",message:"验证码已发送到您的邮箱，请查收。"}),u(!0)}),[v]),[w,C]=Object(y.a)((async()=>{try{const e=await d.a.post("login"===r?"/login":"/register",v);a(e.data)}catch(e){Object(d.c)(e)&&gt.show({intent:"warning",message:e.message})}}),[r,v,a]);return Object(n.useImperativeHandle)(t,(()=>({clear(){f(vt)},focus(e){var t,a;"user"===e?null===(t=E.current)||void 0===t||t.focus():"pwd"===e&&(null===(a=p.current)||void 0===a||a.focus())}})),[]),l.a.createElement("form",{onSubmit:e=>{e.preventDefault(),"register"!==r||s?C():O()}},l.a.createElement("div",{className:"bp3-dialog-body"},c,l.a.createElement(m.o,{label:"邮箱"},l.a.createElement(m.x,{disabled:w.loading,inputRef:E,value:v.email,onChange:e=>{f((t=>({...t,email:e.target.value})))},required:!0,type:"email",pattern:"\\b[\\w.-]+@[\\w.-]+\\.\\w{2,4}\\b"})),l.a.createElement(m.o,{label:"密码"},l.a.createElement(m.x,{disabled:w.loading,inputRef:p,value:v.pwd,onChange:e=>{f((t=>({...t,pwd:e.target.value})))},rightElement:l.a.createElement(m.d,{icon:i?"eye-open":"eye-off",minimal:!0,onClick:()=>{var e;o((e=>!e)),null===(e=p.current)||void 0===e||e.focus()}}),type:i?"text":"password",required:!0,minLength:6,maxLength:20})),s&&l.a.createElement(m.o,{label:"验证码"},l.a.createElement(m.x,{inputRef:b,disabled:w.loading,value:v.vk,onChange:e=>{f((t=>({...t,vk:e.target.value})))},required:!0}))),l.a.createElement("div",{className:"bp3-dialog-footer"},l.a.createElement("div",{className:"bp3-dialog-footer-actions",style:{alignItems:"center"}},"login"===r&&l.a.createElement("a",{href:"https://hcfy.limingkai.cn/forget.html",target:"_blank",rel:"noreferrer"},"忘记密码？"),l.a.createElement(m.d,{text:g,loading:x.loading||w.loading,type:"submit",intent:"primary",style:{marginLeft:"15px"}}))))}));function yt(e){const{open:t}=e,a=Object(n.useRef)(),r=Object(n.useRef)(null),{setUser:c,setShowVip:o,setShowLogin:s}=Object(n.useContext)(b),u=Object(i.f)(),d=()=>{var e;null===(e=a.current)||void 0===e||e.clear()},E="登录";return l.a.createElement(l.a.Fragment,null,l.a.createElement(f,{ref:r}),l.a.createElement(m.l,{isOpen:t,onClose:()=>{s(!1),d()},onClosed:d,onOpened:()=>{var e;null===(e=a.current)||void 0===e||e.focus("user")},title:E},l.a.createElement(ft,{ref:a,onLogin:e=>{var t;s(!1),c(e),e.vipActivated?null===(t=r.current)||void 0===t||t.syncOptions():o(!0)},openType:"login",tip:l.a.createElement("p",null,"划词翻译无需",E,"即可免费使用，只有当你要用",l.a.createElement("a",{onClick:()=>{s(!1),o(!0)}},"会员功能"),"或",l.a.createElement("a",{onClick:()=>{s(!1),u.push("/services?tab=points")}},"翻译积分"),"时才需要",E,"。")})))}var kt=a(115);function xt(e){return e.key}function Ot(e){return{key:e.id,secret:e.key,legacy:e.legacy||!1}}const wt=Et.a;function Ct(e){var t,a,r,c,i;const{service:o,onClick:s,active:u,summary:d,pointsSummary:E,secretKeySummary:p}=e,h=null!=u,b=!(null===(t=o.secretKey)||void 0===t?void 0:t.idLabel),g=o.points,v=null===(a=o.secretKey)||void 0===a?void 0:a.storageKey,f=Object(n.useMemo)((()=>v?{[v]:x.b[v]}:void 0),[v]),[y,k]=Object(O.a)(f),[w,C]=Object(n.useState)("points"),{secretKey:j,transform:T}=function(e){let t,a;return null!=e&&("string"==typeof e?(t={id:"",key:e},a=xt):"secret"in e?(t={id:e.key,key:e.secret,legacy:e.legacy},a=Ot):(t=e,a=wt)),{secretKey:t,transform:a}}(null==y?void 0:y[v||""]);Object(n.useEffect)((()=>{(null==j?void 0:j.key)&&(b||(null==j?void 0:j.id))&&C("secretKey")}),[b,null==j?void 0:j.id,null==j?void 0:j.key]);const S=Object(n.useCallback)((e=>{v&&T&&k({[v]:T(e)})}),[k,v,T]),N=o.secretKey&&(!o.secretKey.legacy||o.secretKey.legacy&&(null==j?void 0:j.legacy));return l.a.createElement(m.g,{className:u?"active":void 0},l.a.createElement(m.r,null,o.name),d,(N||g)&&l.a.createElement(m.P,{id:o.id,selectedTabId:w,onChange:e=>C(e)},l.a.createElement(m.O,{id:"points",title:"翻译积分",panel:l.a.createElement("div",{className:"bp3-text-small bp3-text-muted"},g?E||"正在加载，请稍候……":"此服务不能使用翻译积分。")}),l.a.createElement(m.O,{id:"secretKey",title:"申请密钥",panel:N?j&&l.a.createElement("div",null,!b&&l.a.createElement(m.o,{label:null===(r=o.secretKey)||void 0===r?void 0:r.idLabel,inline:!0},l.a.createElement(m.x,{value:j.id,onChange:e=>{const t=e.target.value;S({id:t,key:j.key,legacy:null==j?void 0:j.legacy})}})),l.a.createElement(m.o,{label:null===(c=o.secretKey)||void 0===c?void 0:c.keyLabel,inline:!0},l.a.createElement(m.x,{value:j.key,type:"password",onChange:e=>{const t=e.target.value;S({id:j.id,key:t,legacy:null==j?void 0:j.legacy})}})),l.a.createElement("div",{className:"bp3-text-small bp3-text-muted"},p||"正在加载，请稍候……",(null===(i=o.secretKey)||void 0===i?void 0:i.keyDocLink)&&l.a.createElement("a",{href:o.secretKey.keyDocLink,target:"_blank",rel:"noreferrer"},"点击查看申请步骤"))):l.a.createElement("div",{className:"bp3-text-small bp3-text-muted"},o.name+"不支持通过密钥使用。")})),h&&l.a.createElement("div",{style:{marginTop:15}},l.a.createElement(m.d,{onClick:s,disabled:u,text:u?"已选中此服务":"选择此服务"})))}function jt(e){const{name:t,description:a,services:r,summaryMap:c,selectedStorageKey:i}=e,o=Object(n.useMemo)((()=>{if(i)return{[i]:x.a[i]}}),[i]),[s,u]=Object(O.a)(o),d=i?null==s?void 0:s[i]:void 0,E=Object(n.useCallback)((e=>{i&&u({[i]:e})}),[i,u]);return l.a.createElement("div",null,l.a.createElement(m.p,null,t),a&&l.a.createElement("p",null,a),l.a.createElement("div",{className:"services-box"},r.map((e=>{const t=e.id;return l.a.createElement(Ct,{key:t,service:e,summary:c.common[t],secretKeySummary:c.secretKey[t],pointsSummary:c.points[t],active:d?d===t:void 0,onClick:()=>{E(t)}})}))))}var Tt=a(224),St=a(247);const Nt=[Tt.b,St.a];var Pt=a(133);const At={BaiDuDomain:"支持五个专业领域：网络文学、金融财经、科技电子、水利机械、生物医药。",ALiOfficialDomain:"支持六个专业领域：电商 - 商品标题、电商 - 商品详情、电商 - 买卖家沟通、医疗、社交、金融。",SoGouOfficial:"支持将中文词组翻译为英语词组（带拼音）；支持英语词典（带音标）和日语词典。",YouDaoWeb:"支持中文词组翻译为英语词组（带拼音）；支持英语词典（带音标）。",tesseractocr:l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,l.a.createElement("a",{href:"https://github.com/tesseract-ocr/tesseract#readme",target:"_blank",rel:"noreferrer"},"Tesseract OCR")," ","无需翻译积分或密钥即可免费使用，但是："),l.a.createElement(m.V,null,l.a.createElement("li",null,"识别时间较长，大约需要 2 ~ 8 秒。"),l.a.createElement("li",null,"准确率相对较低。"),l.a.createElement("li",null,"不能自动判断图片里的语种，识别前需要手动指定。"),l.a.createElement("li",null,"会占用一定的系统资源，偶尔会导致电脑卡顿。"))),bdocr:l.a.createElement(l.a.Fragment,null,l.a.createElement(m.V,null,l.a.createElement("li",null,"识别时间只需 1 秒不到。"),l.a.createElement("li",null,"准确率高。"),l.a.createElement("li",null,"能自动判断图片里的语种，无需手动指定。"),l.a.createElement("li",null,"不占用系统资源。"))),"default-speech":l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,"划词翻译内置的语音转文字服务无需翻译积分或密钥即可免费使用，但是："),l.a.createElement(m.V,null,l.a.createElement("li",null,"需要能连接外网才能使用。"),l.a.createElement("li",null,"只能通过麦克风使用，不能用于音视频翻译功能。"),l.a.createElement("li",null,"不支持 Firefox 浏览器。"))),TencentRealtime:l.a.createElement(m.V,null,l.a.createElement("li",null,"无需连接外网即可使用。"),l.a.createElement("li",null,"既可以通过麦克风使用，也可以用于音视频翻译功能。"),l.a.createElement("li",null,"支持 Firefox 浏览器。"))};function Lt(){const{setShowBuyPoints:e,user:t,setUser:a,setShowLogin:r}=Object(n.useContext)(b),c=!!t;Object(n.useEffect)((()=>{c&&d.a.get("/user-info").then((e=>{a(e.data)}))}),[a,c]);const[i,o]=Object(n.useState)({common:At,points:{},secretKey:{}});return Object(n.useEffect)((()=>{kt.a.get("/summary.json").then((e=>{o(Object(ee.b)((t=>{t.points=e.data.points,t.secretKey=e.data.secretKey})))}))}),[]),l.a.createElement("div",{id:"services"},l.a.createElement(m.f,{title:"关于第三方服务"},l.a.createElement("p",null,"划词翻译的部分功能依赖下面这些第三方服务。你可以购买翻译积分使用这些服务，也可以自行申请密钥使用它们的免费额度。"),l.a.createElement("p",null,l.a.createElement("b",null,"自行申请密钥时，这些服务的免费额度是由它们各自的官方平台提供的，超出免费额度后产生的费用也是由它们各自的官方平台收取，与划词翻译无关。"),"这些密钥只会保存在你的浏览器中，划词翻译不会上传你的密钥。",l.a.createElement("b",null,"请妥善保管好你的密钥，不要将密钥分享给其他人或者不小心泄露出去！"),"他人一旦得到了你的密钥，就可以使用你在这些平台里的免费额度和资金！"),l.a.createElement(m.b,{href:"https://hcfy.limingkai.cn/docs/services/intro",target:"_blank"},"查看这些服务的详细介绍及对比")),l.a.createElement(m.f,{intent:"primary",icon:null,style:{margin:"15px 0"}},"剩余翻译积分：",t?t.points||0:l.a.createElement("a",{onClick:()=>r(!0)},"请登录后查看"),l.a.createElement(m.d,{style:{margin:"0 15px"},intent:"primary",onClick:()=>{e(!0)}},"购买翻译积分"),l.a.createElement("span",{className:"bp3-text-small bp3-text-muted"},"1 元可购买 1,000 翻译积分，多买多送。")),l.a.createElement(jt,{name:"翻译服务",services:Pe.b,summaryMap:i}),l.a.createElement(jt,{name:"图片转文字（OCR）服务",description:"截图翻译和图片翻译功能会使用你选中的服务将图片转为文字。",services:Nt,summaryMap:i,selectedStorageKey:"ocrService"}),l.a.createElement(jt,{name:"语音转文字服务",description:"语音翻译和音视频翻译功能会使用这些服务将语音转为文字。",services:Pt.c,summaryMap:i}))}function Ft(e){const{docURL:t}=e,a=Object(R.a)((async()=>(await kt.a.get(t)).data),[t]);return a.loading?l.a.createElement("p",null,"正在加载，请稍候……"):a.error?l.a.createElement("p",null,"加载失败，请稍后重试。"):l.a.createElement("div",{dangerouslySetInnerHTML:{__html:a.value?Object(w.sanitize)(a.value,{USE_PROFILES:{html:!0},ADD_ATTR:["target"]}):"加载失败，请稍后重试。"}})}function Rt(e){const{nextBtnText:t,summaryURL:a,onNext:r,onLogin:c}=e,{user:i}=Object(n.useContext)(b);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"bp3-dialog-body"},l.a.createElement(Ft,{docURL:a})),l.a.createElement("div",{className:"bp3-dialog-footer"},l.a.createElement("div",{className:"bp3-dialog-footer-actions",style:{alignItems:"center"}},!i&&l.a.createElement("a",{onClick:c},"已有账号？去登录"),l.a.createElement(m.d,{intent:"primary",text:t||"下一步",onClick:r}))))}var Dt=a(678);const It=[{label:"支付宝",value:"alipay"},{label:"微信",value:"wx"}],Kt=browser.runtime.getURL("/payjs.png");function Bt(e){var t;const{onPaid:a,priceURL:r,createOrderAPI:c}=e,[i,o]=Object(n.useState)("alipay"),[s,u]=Object(n.useState)(""),E=null===(t=It.find((e=>e.value===i)))||void 0===t?void 0:t.label,p=Object(R.a)((async()=>{const e=(await kt.a.get(r)).data;return u(e[0].value),e}),[r]),h=Object(R.a)((async()=>{if(!s)return;return(await d.a.post(c,{id:s,method:i})).data}),[i,s,c]),b=h.value;return Object(n.useEffect)((()=>{if(!b)return;const e=window.setInterval((async()=>{if(!b)return;let e;try{e=await d.a.get("/checkOrder",{params:{orderId:b.orderId}})}catch(e){return}e.data.paid&&a(e.data.user)}),1e3);return()=>{window.clearInterval(e)}}),[a,b]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"bp3-dialog-body"},l.a.createElement(m.J,{label:"请选择支付方式:",inline:!0,options:It,selectedValue:i,onChange:e=>{o(e.currentTarget.value)}}),p.loading?l.a.createElement("p",null,"正在加载价格信息，请稍候……"):p.error?l.a.createElement("p",null,"价格信息加载失败，请稍后重试。"):l.a.createElement(m.J,{label:"请选择：",inline:!0,onChange:e=>{u(e.currentTarget.value)},selectedValue:s,options:p.value}),l.a.createElement("p",null,"请使用",l.a.createElement("b",{style:{fontSize:20}},E),"扫描下方二维码支付："),h.loading?l.a.createElement("p",null,"正在加载二维码，请稍候……"):h.error?l.a.createElement("p",null,"加载二维码时出错，请稍后重试。错误信息：",l.a.createElement("span",{style:{color:"#FFB366"}},h.error.message)):b&&l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,l.a.createElement("img",{src:b.qrUrl,width:280,height:280,alt:"支付二维码"})),l.a.createElement("p",{className:"bp3-text-muted"},"当你完成支付后，此页面一般会在 5 秒内自动跳转，在跳转之前请不要关闭窗口。如果 1 分钟后还没有跳转，你可以退出登录后再重新登录试试。")),l.a.createElement("div",{className:"bp3-text-muted bp3-text-small",style:{textAlign:"right"}},"支付能力由",l.a.createElement("img",{style:{cursor:"pointer",verticalAlign:"middle",margin:"0 8px",position:"relative",top:-1,backgroundColor:"rgb(41, 55, 66)"},src:Kt,alt:"PAYJS",width:71,height:20,onClick:()=>window.open("https://payjs.cn/ref/vdyend")}),"提供")))}const Mt=l.a.createElement(m.w,{icon:"tick-circle",intent:"success"});function Vt(e){const{user:t,setUser:a}=Object(n.useContext)(b),{onFinish:r,generateSuccessMsg:c,priceURL:i,createOrderAPI:o,onPaid:s}=e,u=Object(n.useRef)(),[d,E]=Object(n.useState)(t?1:0),[p,h]=Object(n.useState)([{text:"第一步：注册账号"},{text:"第二步：购买"},{text:"完成"}]);return Object(n.useEffect)((()=>{var e;switch(h((e=>{const t=Object(Dt.a)(e);return t.forEach(((e,t)=>{t<d?(e.current=!1,e.icon=Mt):t===d?(e.current=!0,delete e.icon):(e.current=!1,delete e.icon)})),t})),d){case 0:return void(null===(e=u.current)||void 0===e||e.focus("user"))}}),[d]),l.a.createElement(l.a.Fragment,null,l.a.createElement(m.c,{className:"buy-steps",items:p,overflowListProps:{minVisibleItems:3}}),0===d&&l.a.createElement(ft,{ref:u,onLogin:e=>{a(e),E((e=>e+1))},openType:"register"}),1===d&&l.a.createElement(Bt,{priceURL:i,createOrderAPI:o,onPaid:e=>{a(e),s&&s(),E((e=>e+1))}}),2===d&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"bp3-dialog-body"},"支付成功！",t&&c(t)),l.a.createElement("div",{className:"bp3-dialog-footer"},l.a.createElement("div",{className:"bp3-dialog-footer-actions"},l.a.createElement(m.d,{text:"完成",intent:"primary",onClick:r})))))}const _t={0:{title:"开通会员",docURL:"/vip-short-summary.html",summaryBtnText:"开通会员",docPricesURL:"/prices.json",qrAPI:"/getPayQR",generateSuccessMsg:e=>e.forever?"您的会员永不过期":`您的会员到期时间为 ${h(e).endTime}。`,onPaid:()=>{browser.runtime.sendMessage({action:"sync data"})}},1:{title:"购买翻译积分",docURL:void 0,summaryBtnText:void 0,docPricesURL:"/points.json",qrAPI:"/getPointsPayQR",onPaid:void 0,generateSuccessMsg:e=>`您的翻译积分数量为 ${e.points}。`}};function Ut(e){const{isOpen:t,buyType:a}=e,r=_t[a],c=r.docURL?0:1,[i,o]=Object(n.useState)(c),{setShowVip:s,setShowLogin:u,setShowBuyPoints:d}=Object(n.useContext)(b);let E;switch(a){case 0:E=s;break;case 1:E=d;break;default:throw new TypeError(`不支持的购买类型：${a}`)}const p=()=>{E(!1)},h=()=>{p(),o(c)};return l.a.createElement(m.l,{isOpen:t,canOutsideClickClose:!1,canEscapeKeyClose:!1,onClose:h,title:r.title},r.docURL&&0===i&&l.a.createElement(Rt,{summaryURL:r.docURL,nextBtnText:r.summaryBtnText,onNext:()=>{o((e=>e+1))},onLogin:()=>{p(),u(!0)}}),1===i&&l.a.createElement(Vt,{priceURL:r.docPricesURL,createOrderAPI:r.qrAPI,onPaid:r.onPaid,generateSuccessMsg:r.generateSuccessMsg,onFinish:h}))}s.a.onlyShowFocusOnTabs(),pt||(d.a.interceptors.response.use(Et.a,(e=>{const t={intent:"danger",message:""};if(Object(d.b)(e))if(e.response){const a=e.response.status;t.message=bt[a]||"未知错误，请稍后重试。错误码："+a}else e.request?t.message="服务器没有响应，请稍后重试。":t.message=e.message;else Object(d.c)(e)&&"VIP_OUTDATED"===e.errorCode&&(t.message="您的会员已过期。");return t.message&&ht.show(t),Promise.reject(e)})),pt=!0);const qt="?vip"===window.location.search,Ht="?login"===window.location.search,zt=Object(k.a)(x.b,"user");a(652);c.a.render(l.a.createElement(o.a,null,l.a.createElement((function(){Object(u.a)();const e=Object(i.g)(),[t,a]=Object(n.useState)(qt),[r,c]=Object(n.useState)(Ht),[s,d]=Object(n.useState)(!1),[E,p]=Object(O.a)(zt),h=(null==E?void 0:E.user)||null,g=Object(n.useCallback)((e=>{p({user:e})}),[p]);return l.a.createElement(b.Provider,{value:{setShowVip:a,user:h,setUser:g,setShowLogin:c,setShowBuyPoints:d}},l.a.createElement(Ut,{isOpen:t,buyType:0}),l.a.createElement(Ut,{isOpen:s,buyType:1}),l.a.createElement(yt,{open:r}),l.a.createElement(P,null),l.a.createElement("div",{id:"main"},l.a.createElement(m.g,{id:"left-nav"},l.a.createElement(m.y,{large:!0,style:{position:"fixed"}},l.a.createElement(o.b,{to:"/"},l.a.createElement(m.A,{active:"/"===e.pathname,tagName:"span",icon:"cog",text:"设置"})),l.a.createElement(o.b,{to:"/stars"},l.a.createElement(m.A,{active:"/stars"===e.pathname,tagName:"span",icon:"folder-open",text:"收藏夹"})),l.a.createElement(o.b,{to:"/history"},l.a.createElement(m.A,{active:"/history"===e.pathname,tagName:"span",icon:"history",text:"历史记录"})),l.a.createElement(m.z,null),l.a.createElement(m.A,{tagName:"span",icon:"crown",text:"开通会员",onClick:()=>{a(!0)}}),l.a.createElement(o.b,{to:"/services"},l.a.createElement(m.A,{active:"/services"===e.pathname,tagName:"span",icon:"applications",text:"服务申请"})),l.a.createElement(m.A,{icon:"clean",text:"邀请有礼",target:"_blank",href:"https://hcfy.limingkai.cn/docs/invite"}),l.a.createElement(o.b,{to:"/about"},l.a.createElement(m.A,{active:"/about"===e.pathname,tagName:"span",icon:"info-sign",text:"关于划词翻译"})))),l.a.createElement("div",{className:"right-content"},l.a.createElement(i.c,null,l.a.createElement(i.a,{path:"/services"},l.a.createElement(Lt,null)),l.a.createElement(i.a,{path:"/history"},l.a.createElement(et,null)),l.a.createElement(i.a,{path:"/stars"},l.a.createElement(dt,null)),l.a.createElement(i.a,{path:"/about"},l.a.createElement(Ve,null)),l.a.createElement(i.a,{path:"/"},l.a.createElement(Be,null))))))}),null)),document.getElementById("app"))}});