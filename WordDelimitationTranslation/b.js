!function(e){function t(t){for(var r,s,i=t[0],c=t[1],l=t[2],d=0,b=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&b.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);b.length;)b.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],r=!0,i=1;i<a.length;i++){var c=a[i];0!==o[c]&&(r=!1)}r&&(n.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},o={10:0},n=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;n.push([444,0,2,8,1,6]),a()}({108:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return n}));var r=a(57);async function o(e){var t;try{let t;if(t=void 0===e?(await browser.tabs.executeScript({code:"window.location.href",runAt:"document_start"}))[0]:(await browser.tabs.executeScript(e,{code:"window.location.href",runAt:"document_start"}))[0],t.startsWith("moz-extension"))throw new Error;return t}catch(a){if(void 0===e&&!(e=null===(t=await Object(r.a)())||void 0===t?void 0:t.id))return;try{return await browser.tabs.sendMessage(e,"get tab url")}catch(e){}}}function n(){const e=e=>{if("get tab url"===e)return Promise.resolve(window.location.href)};return browser.runtime.onMessage.addListener(e),()=>{browser.runtime.onMessage.removeListener(e)}}},249:function(e,t,a){"use strict";var r=a(29),o=a(28),n=function(){return o.a.Date.now()},s=a(84),i=Math.max,c=Math.min;t.a=function(e,t,a){var o,l,u,d,b,m,f=0,p=!1,g=!1,w=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var a=o,r=l;return o=l=void 0,f=t,d=e.apply(r,a)}function v(e){return f=e,b=setTimeout(k,t),p?h(e):d}function y(e){var a=e-m;return void 0===m||a>=t||a<0||g&&e-f>=u}function k(){var e=n();if(y(e))return x(e);b=setTimeout(k,function(e){var a=t-(e-m);return g?c(a,u-(e-f)):a}(e))}function x(e){return b=void 0,w&&o?h(e):(o=l=void 0,d)}function j(){var e=n(),a=y(e);if(o=arguments,l=this,m=e,a){if(void 0===b)return v(m);if(g)return clearTimeout(b),b=setTimeout(k,t),h(m)}return void 0===b&&(b=setTimeout(k,t)),d}return t=Object(s.a)(t)||0,Object(r.a)(a)&&(p=!!a.leading,u=(g="maxWait"in a)?i(Object(s.a)(a.maxWait)||0,t):u,w="trailing"in a?!!a.trailing:w),j.cancel=function(){void 0!==b&&clearTimeout(b),f=0,o=m=l=b=void 0},j.flush=function(){return void 0===b?d:x(n())},j}},400:function(e,t,a){"use strict";const r=a(608),o=a(609);e.exports=e=>{const t=`(?:${"(?:(?:[a-z]+:)?//)"+((e={strict:!0,...e}).strict?"":"?")}|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|${r.v4().source}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*${`(?:\\.${e.strict?"(?:[a-z\\u00a1-\\uffff]{2,})":`(?:${o.sort(((e,t)=>t.length-e.length)).join("|")})`})\\.?`})(?::\\d{2,5})?(?:[/?#][^\\s"]*)?`;return e.exact?new RegExp(`(?:^${t}$)`,"i"):new RegExp(t,"ig")}},444:function(e,t,a){e.exports=a(659)},445:function(e,t){var a=["blocking","responseHeaders"],r=/Chrome\/(\d+)/.exec(navigator.userAgent);(r&&Number(r[1]))>71&&a.push("extraHeaders"),chrome.webRequest.onHeadersReceived.addListener((function(e){var t=e.responseHeaders,a=t.findIndex((e=>"content-security-policy"===e.name.toLowerCase()));return-1!==a&&t.splice(a,1),{responseHeaders:t}}),{urls:["https://www.deepl.com/translator"],types:["sub_frame"]},a)},446:function(e,t){chrome.webRequest.onBeforeSendHeaders.addListener((function(e){var t=e.requestHeaders;return t.some((function(e){if("hcfy-Date"===e.name)return e.name="Date",!0})),{requestHeaders:t}}),{urls:["https://mt.cn-hangzhou.aliyuncs.com/api/translate/web/general","https://mt.cn-hangzhou.aliyuncs.com/api/translate/web/ecommerce"],types:["xmlhttprequest"]},["blocking","requestHeaders"])},447:function(e,t){var a=["blocking","responseHeaders"],r=/Chrome\/(\d+)/.exec(navigator.userAgent);(r&&Number(r[1]))>71&&a.push("extraHeaders"),chrome.webRequest.onHeadersReceived.addListener((function(e){var t=e.responseHeaders,a=t.findIndex((e=>"cross-origin-resource-policy"===e.name.toLowerCase()));return-1!==a&&t.splice(a,1),{responseHeaders:t}}),{urls:["https://translate.googleapis.com/translate_tts?*"]},a)},46:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return s}));const r=browser.runtime.getURL("/pdf-viewer/web/viewer.html");function o(e){return e.startsWith(r)}function n(e){let t,a,o;e&&("string"==typeof e?t=e:(t=e.file,a=e.blocked,o=e.incognito));let n="",s="";if(t){const e=new URL(t);n+=`&file=${encodeURIComponent(t)}`,s=e.hash}return a&&(n+="&_blocked"),o&&(n+="&_incognito"),r+n.replace("&","?")+s}function s(e){return async function(e){const t=await browser.tabs.create({url:e}),a=await browser.windows.get(t.windowId);a.focused||await browser.windows.update(a.id,{drawAttention:!0})}(n(e))}},57:function(e,t,a){"use strict";async function r(){return(await browser.tabs.query({active:!0,highlighted:!0,windowId:browser.windows.WINDOW_ID_CURRENT}))[0]}a.d(t,"a",(function(){return r}))},608:function(e,t,a){"use strict";const r="[a-fA-F\\d:]",o=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${r})|(?<=${r})(?=\\s|$))`:"",n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",i=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${n}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${n}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${n}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${n}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${n}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${n}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${n}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),c=new RegExp(`(?:^${n}$)|(?:^${i}$)`),l=new RegExp(`^${n}$`),u=new RegExp(`^${i}$`),d=e=>e&&e.exact?c:new RegExp(`(?:${o(e)}${n}${o(e)})|(?:${o(e)}${i}${o(e)})`,"g");d.v4=e=>e&&e.exact?l:new RegExp(`${o(e)}${n}${o(e)}`,"g"),d.v6=e=>e&&e.exact?u:new RegExp(`${o(e)}${i}${o(e)}`,"g"),e.exports=d},609:function(e){e.exports=JSON.parse('["aaa","aarp","abarth","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","adac","ads","adult","ae","aeg","aero","aetna","af","afamilycompany","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alfaromeo","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","avianca","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","bananarepublic","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","bentley","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","budapest","bugatti","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","cancerresearch","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cbs","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","cityeats","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","comcast","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cookingchannel","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","csc","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","duck","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","etisalat","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fiat","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","foodnetwork","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontdoor","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glade","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","guardian","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hgtv","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hoteles","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","iveco","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerrylogistics","kerryproperties","kfh","kg","kh","ki","kia","kim","kinder","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","lancaster","lancia","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","linde","link","lipsy","live","living","lixil","lk","llc","llp","loan","loans","locker","locus","loft","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","macys","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","maserati","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","mutual","mv","mw","mx","my","mz","na","nab","nagoya","name","nationwide","natura","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","northwesternmutual","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","off","office","okinawa","olayan","olayangroup","oldnavy","ollo","om","omega","one","ong","onl","online","onyourside","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","passagens","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","pramerica","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","qvc","racing","radio","raid","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","rmit","ro","rocher","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","sca","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scjohnson","scot","sd","se","search","seat","secure","security","seek","select","sener","services","ses","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shaw","shell","shia","shiksha","shoes","shop","shopping","shouji","show","showtime","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","spreadbetting","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiftcover","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tiffany","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelchannel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volkswagen","volvo","vote","voting","voto","voyage","vu","vuelos","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xfinity","xihuan","xin","कॉम","セール","佛山","ಭಾರತ","慈善","集团","在线","한국","ଭାରତ","大众汽车","点看","คอม","ভাৰত","ভারত","八卦","ישראל","موقع","বাংলা","公益","公司","香格里拉","网站","移动","我爱你","москва","қаз","католик","онлайн","сайт","联通","срб","бг","бел","קום","时尚","微博","淡马锡","ファッション","орг","नेट","ストア","アマゾン","삼성","சிங்கப்பூர்","商标","商店","商城","дети","мкд","ею","ポイント","新闻","家電","كوم","中文网","中信","中国","中國","娱乐","谷歌","భారత్","ලංකා","電訊盈科","购物","クラウド","ભારત","通販","भारतम्","भारत","भारोत","网店","संगठन","餐厅","网络","ком","укр","香港","亚马逊","诺基亚","食品","飞利浦","台湾","台灣","手机","мон","الجزائر","عمان","ارامكو","ایران","العليان","اتصالات","امارات","بازار","موريتانيا","پاکستان","الاردن","بارت","بھارت","المغرب","ابوظبي","البحرين","السعودية","ڀارت","كاثوليك","سودان","همراه","عراق","مليسيا","澳門","닷컴","政府","شبكة","بيتك","عرب","გე","机构","组织机构","健康","ไทย","سورية","招聘","рус","рф","تونس","大拿","ລາວ","みんな","グーグル","ευ","ελ","世界","書籍","ഭാരതം","ਭਾਰਤ","网址","닷넷","コム","天主教","游戏","vermögensberater","vermögensberatung","企业","信息","嘉里大酒店","嘉里","مصر","قطر","广东","இலங்கை","இந்தியா","հայ","新加坡","فلسطين","政务","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw"]')},659:function(e,t,a){"use strict";a.r(t);a(445),a(446),a(447);var r=a(3),o=a(90),n=a(37),s=a(179),i=a(180),c=a(215),l=a(159),u=a(248),d=a(244),b=a(245),m=a(219),f=a(42),p=a(44),g=a(19),w=a.n(g);Object(o.a)(r.a,["customAPI"]);class h extends f.a{constructor(e){super({id:e,name:e})}async translateInner(e,t,a){return{context:{text:e},raw:await this.queryDirect(e,t.join(","),a)}}async queryDirect(e,t,a){const{customAPI:r}=await browser.storage.local.get("customAPI");if(!r)throw new p.a({type:"OTHER",message:"没有配置自定义翻译源。"});return(await w.a.post(r,{text:e,destination:t.split(","),source:a,name:this.service.name})).data}transform(e,t){return t||{text:e.text}}}var v=a(144);function y(e){switch(e){case"DeepLWeb":return m.a;case"GoogleWeb":return v.a;case"BaiDuWeb":return i.c;case"BaiDuDomain":return i.a;case"YouDaoWeb":return b.a;case"BingDictWeb":return l.a;case"ALiOfficial":return s.c;case"ALiOfficialDomain":return s.a;case"QQOfficial":return c.a;case"SoGouOfficial":return d.a;case"CaiYunOfficial":return u.a;default:return new h(e)}}Object(n.a)(Object(o.a)(r.a,["googleRegion"]),(e=>{e.googleRegion&&(v.a.region=e.googleRegion)}));const k=Object(o.a)(r.a,["destination","secondDestination"]);var x=a(89),j=a(31),O=a.n(j),$=a(26);const R=O()("audio"),L={...Object(o.a)(r.a,["audioVolume","audioRate","systemTTS","systemTTSVoice","systemTTSAccent"]),...Object(o.a)(r.b,["user"])};let I,P=r.a.audioVolume,T=r.a.audioRate,S=r.a.systemTTS,z=r.a.systemTTSVoice,A=r.a.systemTTSAccent,D=r.b.user;Object(n.a)(L,(e=>{null!=e.audioRate&&(T=e.audioRate,I&&(I.playbackRate=T)),null!=e.audioVolume&&(P=e.audioVolume,I&&(I.volume=P/100)),null!=e.systemTTS&&(S=e.systemTTS),null!=e.systemTTSVoice&&(z=e.systemTTSVoice),null!=e.systemTTSAccent&&(A=e.systemTTSAccent),void 0!==e.user&&(D=e.user)}));var C,q,U=a(57);let E,W;browser.windows.onRemoved.addListener((e=>{E===e&&(E=void 0)})),(null===(q=null===(C=null===window||void 0===window?void 0:window.chrome)||void 0===C?void 0:C.windows)||void 0===q?void 0:q.onBoundsChanged)&&chrome.windows.onBoundsChanged.addListener((e=>{e.id===E&&browser.storage.local.set({panelPos:Object(o.a)(e,["width","height","left","top"])})}));const B=Object(o.a)(r.a,["panelPos"]);async function M(e=""){if(void 0!==E&&void 0!==W)await Promise.all([browser.tabs.sendMessage(W,{action:"translateInPopup",data:e}),browser.windows.update(E,{focused:!0})]);else{const t=await browser.storage.local.get(B),a=await browser.windows.create({url:browser.runtime.getURL("panel.html")+"?text="+encodeURIComponent(e),type:"popup",...t.panelPos});0,E=a.id,W=a.tabs&&a.tabs[0].id}}async function N(e="",t,a=!0){var r;if(t||(t=null===(r=await Object(U.a)())||void 0===r?void 0:r.id))try{await browser.tabs.sendMessage(t,"translate")}catch(t){a&&M(e)}else a&&M(e)}var _=a(32),H=a(108),F=a(46);async function K(e){return"normal"===(await browser.windows.get(e)).type}async function V(e){if(!e)return void await browser.browserAction.setIcon({path:"logogray.png"});if(Object(F.b)(e))return void await browser.browserAction.setIcon({path:"logo.png"});const{domainBlackList:t,domainWhiteList:a}=await browser.storage.local.get(Object(o.a)(r.a,["domainBlackList","domainWhiteList"])),n=Object(_.c)(e,t,a);await browser.browserAction.setIcon({path:n?"logo.png":"logogray.png"})}async function G(e){let t,a;if(e)t=e.tabId,a=e.windowId;else{const e=await Object(U.a)();if(!e)return V();t=e.id,a=e.windowId}if(null==a||await K(a))return V(await Object(H.a)(t))}G(),browser.tabs.onActivated.addListener((e=>{G(e)})),browser.tabs.onUpdated.addListener(((e,t)=>{"loading"===t.status&&G()})),browser.windows.onFocusChanged.addListener((async e=>{e!==browser.windows.WINDOW_ID_NONE&&await K(e)&&G()})),browser.storage.onChanged.addListener(((e,t)=>{"local"===t&&(e.hasOwnProperty("domainBlackList")||e.hasOwnProperty("domainWhiteList"))&&G()}));var Y=a(175),J=a(86),Q=a(79);const Z=Object(o.a)(r.b,["user"]);async function X(){const{user:e}=await browser.storage.local.get(Z);return!!e&&e.vipActivated}var ee=a(98),te=a(224),ae=a(247);const re=Object(o.a)(r.a,["ocrService"]),oe=new ee.a("ocrLimit",5);var ne=a(105),se=a(115);const ie={...Object(o.a)(r.b,["user"]),...Object(o.a)(r.a,["noticesRead"])};let ce=[];async function le(e){if(e)try{ce=await se.a.get("/notices.json").then((e=>e.data)),ie.noticesRead=ie.noticesRead.filter((e=>ce.find((t=>t.id===e)))),browser.storage.local.set({noticesRead:ie.noticesRead})}catch(e){}const t=function(e,t,a){let r=0;return{filteredNotices:e.filter((e=>{if(e.filter){if(e.filter.noFree&&!(null==t?void 0:t.vipActivated))return!1;if(e.filter.noVip&&(null==t?void 0:t.vipActivated)&&!t.forever)return!1;if(e.filter.noForever&&(null==t?void 0:t.forever))return!1;if(e.filter.noChrome&&$.a)return!1;if(e.filter.noEdge&&$.b)return!1;e.filter.noFirefox;const a=Date.now();if(e.filter.start&&e.filter.start>a)return!1;if(e.filter.end&&e.filter.end<a)return!1;if(e.filter.versionStart&&Object($.e)(e.filter.versionStart)>0)return!1;if(e.filter.versionEnd&&Object($.e)(e.filter.versionEnd)<0)return!1}return a.includes(e.id)||(r+=1),!0})),unreadNum:r}}(ce,ie.user,ie.noticesRead);browser.storage.local.set({noticesUnreadNum:t.unreadNum,noticesFiltered:t.filteredNotices})}const ue="fetch-notices-alarm";browser.alarms.create(ue,{periodInMinutes:60}),browser.alarms.onAlarm.addListener((async e=>{e.name===ue&&le(!0)})),Object(n.a)(ie,((e,t)=>{void 0!==e.user&&(ie.user=e.user),e.noticesRead&&(ie.noticesRead=e.noticesRead),le(!!t)})),Object(n.a)({noticesUnreadNum:0},(e=>{var t;null!=e.noticesUnreadNum&&(t=e.noticesUnreadNum,browser.browserAction.setBadgeText({text:t?String(t):""}))}));var de=a(15);const be=browser.runtime.getURL("settings.html");browser.runtime.onMessage.addListener((e=>{switch(e.action){case"open options page":return e.suffix?browser.tabs.create({url:be+e.suffix}).then(ne.a):browser.runtime.openOptionsPage();case"translate":return async function(e){const t=y(e.apiCode),a=await browser.storage.local.get(k);return t.translate(e.text,a.destination===a.secondDestination?[a.destination]:[a.destination,a.secondDestination],e.source)}(e.data);case"audio":return async function(e){I&&I.pause(),speechSynthesis.cancel();try{if("prior"===S)throw new Error("由于用户设置了始终使用系统语音朗读，所以主动抛出错误");let t;if(e.ttsURI)t=e.ttsURI;else if(e.source){const a=y(e.apiId);t=await a.getTTS(e.text,e.source)}if(!t)throw new Error("跳过");await new Promise(((e,a)=>{I=new Audio(t),I.volume=P/100,I.playbackRate=T,I.addEventListener("canplay",(()=>{null==I||I.play(),e()})),I.addEventListener("error",(()=>{a()}))}))}catch(t){if("none"===S)throw t;return new Promise((async(t,a)=>{R("开始用系统语音朗读");const r=new SpeechSynthesisUtterance(e.text);r.volume=P/100,r.rate=T;const o=window.setTimeout((()=>{let e;speechSynthesis.cancel(),r.lang&&(e=x.c[r.lang]),a(new Error("系统语音朗读超时。"+($.a?`Chrome 浏览器提供的网络语音需要连接外网才能使用。你也可以前往设置中选择本地语音朗读${e||""}。`:`如果你的网络状况不佳，可以前往设置中选择本地语音朗读${e||""}。`)))}),2e3);if(r.addEventListener("start",(()=>{window.clearTimeout(o),t()})),r.addEventListener("error",(e=>{a(e)})),null==D?void 0:D.vipActivated){const t=e.source&&x.b[e.source];if(t){const e=A[t];e&&(R("指定用户选择的口音："+e),r.lang=e)}}const n=r.lang||e.source&&x.d[e.source];if(n&&(r.lang||(r.lang=n,R("指定文本的语种："+n)),null==D?void 0:D.vipActivated)){const e=z[n];if(e)try{const{voicesGroup:t}=await Object(x.e)(),a=t[n];if(a){const t=a.find((t=>t.name===e));t&&(R("指定系统语音："+t.name),r.voice=t)}}catch(e){}}R("开始朗读"),window.speechSynthesis.speak(r)}))}}(e.url);case"open panel":return M();case"update badge":return G();case"save history record":return X().then((t=>Y.a.add(e.record,t)));case"save favorite":return X().then((t=>{const a=e.record.results;return a&&(e.record.dir=Object(J.b)(a)),J.a.add(e.record,t)}));case"is text in favorites":return Object(J.c)(e.text);case"delete record in favorites":return X().then((t=>J.a.deleteByKey("text",e.text,t)));case"write to clipboard":return Promise.resolve(Object(Q.b)(e.text));case"take screenshot":return browser.tabs.captureVisibleTab(browser.windows.WINDOW_ID_CURRENT,{format:"png"});case"ocr":return async function(e){if(await oe.isOver())throw new Error("非会员每天只能使用 5 次截图翻译功能，成为会员即可解除此限制。");let t;const{ocrService:a}=await browser.storage.local.get(re);switch(a){case"tesseractocr":t=await te.a.ocr(e);break;case"bdocr":t=await ae.b.ocr(e);break;default:throw new TypeError(`不支持的 OCR 服务：${a}`)}return await oe.addOne(),t}(e.dataURI);case"sync data":return Promise.all([Y.a,J.a].map((e=>e.commit())));case"refresh notices":return le(!0);case"get user sid":return de.a.get("https://hs-api.limingkai.cn/sid").then((e=>e.data.sid))}}));const me=Object(o.a)(r.a,["pdfAuto"]);function fe(e){const{tabId:t,frameId:a}=e;browser.tabs.get(t).then((async r=>{r.incognito&&(a||await browser.tabs.remove(t),await Object(F.c)({file:e.url,incognito:!0}))}))}function pe(e){return fe(e),{redirectUrl:Object(F.a)(e.url)}}function ge(e){var t;if("GET"!==e.method)return;let a,r;return null===(t=e.responseHeaders)||void 0===t||t.some((e=>{var t;switch(e.name.toLowerCase()){case"content-type":a=e.value;break;case"content-disposition":r=null===(t=e.value)||void 0===t?void 0:t.trim();break;default:return!(!a||!r)}})),a?(a=a.toLowerCase().split(";",1)[0].trim(),"application/pdf"!==a||r&&!r.startsWith("inline")?void 0:(fe(e),{redirectUrl:Object(F.a)(e.url)})):void 0}Object(n.a)(me,(e=>{null!=e.pdfAuto&&(e.pdfAuto?(browser.webRequest.onBeforeRequest.hasListener(pe)||browser.webRequest.onBeforeRequest.addListener(pe,{urls:["ftp://*/*.pdf","ftp://*/*.PDF","file://*/*.pdf","file://*/*.PDF"],types:["main_frame","sub_frame"]},["blocking"]),browser.webRequest.onHeadersReceived.hasListener(ge)||browser.webRequest.onHeadersReceived.addListener(ge,{urls:["http://*/*","https://*/*"],types:["main_frame","sub_frame"]},["blocking","responseHeaders"])):(browser.webRequest.onBeforeRequest.removeListener(pe),browser.webRequest.onHeadersReceived.removeListener(ge)))}));var we=a(240);var he=function(e){return Object(we.a)(e,4)},ve=a(95),ye=a(164);const ke={YouDao:"YouDaoWeb",BaiDu:"BaiDuWeb",Google:"GoogleWeb",GoogleCN:"GoogleWeb"};browser.runtime.onInstalled.addListener((async e=>{if("update"!==e.reason);else{const t=e.previousVersion?e.previousVersion.split(".").map((e=>Number(e))):void 0,a=7===(null==t?void 0:t[0]);if(t&&6===t[0]){const e=await browser.storage.local.get(),t={};if(t.pdfAuto=null!=e.pdf&&e.pdf,e.disableSelection)t.domainBlackList=[{host:"*",path:"/*"}];else{const a=e.excludeDomains;Array.isArray(a)&&(t.domainBlackList=a.map((e=>({host:`*${"."===e[0]?"":"."}${e}`,path:"/*"}))))}null!=e.showBtn&&(t.button=e.showBtn);const a=e.defaultApi||"GoogleCN",o=ke[a];o&&(t.selectedAPIs=[o]);const n=he(r.a.textList);let s=!1;e.ignoreChinese&&(n[0].enabled=!0,s=!0),e.ignoreNumLike||(n[1].enabled=!1,s=!0),s&&(t.textList=n),await browser.storage.local.clear(),await browser.storage.local.set(t)}if(t&&a&&t[1]<=3){const{modifierKey:e}=await browser.storage.local.get("modifierKey");!1!==e&&await browser.storage.local.set({modifierKeys:["ctrl"],modifierKeyPressedAction:"selection",modifierKeyTranslate:!0}),await browser.storage.local.remove(["region","tipNewGoogleAPI","modifierKey"])}if(t&&a&&4===t[1]&&t[2]>=9&&await browser.storage.local.set({tipOcrChangeClosed:!1}),t&&a&&(t[1]<5||5===t[1]&&t[2]<=2)&&await Promise.all([ve.a.favorites,ve.a.historyRecords].map((e=>e.filter((e=>!e._id&&!e.syncStatus)).modify({syncStatus:ye.b.Pending})))),t&&a&&(4===t[1]||5===t[1]&&t[2]<=2)){const{user:e}=await browser.storage.local.get("user");(null==e?void 0:e.vipActivated)&&await browser.storage.local.set({tipForeverVIPClosed:!1})}if(t&&a&&(t[1]<5||5===t[1]&&t[2]<=5)){const{selectedAPIs:e}=await browser.storage.local.get("selectedAPIs");e||await browser.storage.local.set({selectedAPIs:["BaiDuWeb"]})}if(t&&a&&(t[1]<5||5===t[1]&&t[2]<=6)&&await browser.storage.local.set({pinIgnoreDomainList:!1}),t&&a&&Object($.d)(t,"7.6.8")<=0&&await browser.storage.local.set({tipTextareaBtnClosed:!1}),t&&Object($.d)(t,"8.0.0")<=0){const{baiDuOCRKey:e}=await browser.storage.local.get("baiDuOCRKey");if((null==e?void 0:e.secret)||(null==e?void 0:e.key)){e.legacy=!0;const t=e.secret&&e.key;await browser.storage.local.set(t?{baiDuOCRKey:e,ocrService:"bdocr"}:{baiDuOCRKey:e})}}}}));const xe=["*://*/*","file://*/*","ftp://*/*",Object(F.a)()+"*"];function je(){browser.runtime.lastError}const Oe=["page","frame","link","editable","image","video","audio"];[{id:"translate",title:"翻译这段文本(&Z)",contexts:["selection"]},{id:"open-pdf-in-viewer",title:"在划词翻译中打开此 PDF (&P)",contexts:["all"],documentUrlPatterns:["chrome-extension://mhjfbmdgcfjbbpaeojofohoefgiehjai/*"]},{id:"open-link-in-viewer",title:"在划词翻译中打开此 PDF (&P)",contexts:["link"],targetUrlPatterns:["*://*/*.pdf","*://*/*.PDF","*://*/*.pdf?*","*://*/*.PDF?*","ftp://*/*.pdf","ftp://*/*.PDF","ftp://*/*.pdf?*","ftp://*/*.PDF?*","file://*/*.pdf","file://*/*.PDF","file://*/*.pdf?*","file://*/*.PDF?*"]},{id:"screen-translate",title:"截图翻译",contexts:Oe,documentUrlPatterns:xe},{id:"page-translate",title:"网页全文翻译",contexts:["page"],documentUrlPatterns:xe},{id:"video-translate",title:"音视频翻译",contexts:Oe,documentUrlPatterns:xe}].forEach((e=>{browser.contextMenus.create(e,je)}));const $e={id:"sp-for-quick-link",contexts:["selection"],type:"separator"};let Re=[];const Le="quick-link-",Ie=Le.length,Pe=e=>`quick-link-${e.name}`;Object(n.a)(Object(o.a)(r.a,["quickLinks"]),(async e=>{e.quickLinks&&(await Promise.all(Re.map((e=>browser.contextMenus.remove(Pe(e))))),Re=e.quickLinks.filter((e=>e.menu)),Re.length?(browser.contextMenus.create($e,je),Re.forEach((e=>{browser.contextMenus.create({id:Pe(e),contexts:["selection"],title:e.name})}))):browser.contextMenus.remove($e.id).catch(ne.a))})),browser.contextMenus.onClicked.addListener((async(e,t)=>{switch(e.menuItemId){case"translate":const a=e.selectionText,r=e.pageUrl||"";a&&(r.startsWith("chrome")||r.startsWith("about")?M(a):N(a,null==t?void 0:t.id));break;case"open-pdf-in-viewer":const o=e.srcUrl;o&&!o.startsWith("about:")?Object(F.c)(o):Object(F.c)({blocked:!0});break;case"open-link-in-viewer":e.linkUrl&&Object(F.c)(e.linkUrl);break;case"screen-translate":if(null==t?void 0:t.id)try{await browser.tabs.sendMessage(null==t?void 0:t.id,"screenshot translate")}catch(e){}break;case"page-translate":if(null==t?void 0:t.id)try{await browser.tabs.sendMessage(null==t?void 0:t.id,"page translate")}catch(e){}break;case"video-translate":if(null==t?void 0:t.id)try{await browser.tabs.sendMessage(null==t?void 0:t.id,"video translate")}catch(e){}break;default:if("string"==typeof e.menuItemId&&e.menuItemId.startsWith(Le)){const t=e.menuItemId.slice(Ie),a=Re.find((e=>e.name===t));a&&browser.tabs.create({url:a.link.replace("%s",encodeURIComponent(e.selectionText||""))})}}}));const Te=Object(o.a)(r.a,["domainBlackList"]);browser.commands.onCommand.addListener((async e=>{var t,a,r;let o;switch(e){case"panel":M();break;case"translate":N("",void 0,!1);break;case"translateWithPopup":if(o=null===(t=await Object(U.a)())||void 0===t?void 0:t.id,o)try{M(await browser.tabs.sendMessage(o,"getSelectionText"))}catch(e){}break;case"screenshot":if(o=null===(a=await Object(U.a)())||void 0===a?void 0:a.id,o)try{await browser.tabs.sendMessage(o,"screenshot translate")}catch(e){}break;case"page":if(o=null===(r=await Object(U.a)())||void 0===r?void 0:r.id,o)try{await browser.tabs.sendMessage(o,"page translate")}catch(e){}break;case"switchWeb":const{domainBlackList:e}=await browser.storage.local.get(Te),n=e.findIndex((e=>"*"===e.host&&"/*"===e.path));n>=0?e.splice(n,1):e.unshift({host:"*",path:"/*"}),await browser.storage.local.set({domainBlackList:e})}}));var Se=a(249),ze=a(145);const Ae=Object(o.a)(r.b,"user"),De={...r.a,...Object(o.a)(r.b,["optionsSyncAt"])},Ce=Object(Se.a)(ze.c,5e3);let qe;const Ue="sync alarm",Ee=Object(o.a)(r.a,["notifySyncOptions"]);async function We(){let e;try{e=await Object(ze.b)()}catch(e){return}if("covered"===e&&await browser.permissions.contains({permissions:["notifications"]})){const{notifySyncOptions:e}=await browser.storage.local.get(Ee);if(e)try{await browser.notifications.create("notify for options sync",{type:"basic",iconUrl:"logo.png",title:"划词翻译设置已更新",message:"已将划词翻译设置更新至最新版本。"})}catch(e){browser.storage.local.set({disabledNofiByBrowserUI:!0})}}}function Be(e){e.name===Ue&&We()}function Me(e){return`https://translate.google.com/translate?sl=auto&tl=zh-CN&u=${e}`}function Ne(e){return`https://translate.sogoucdn.com/pcvtsnapshot?from=auto&to=zh-CHS&tfr=translatepc&url=${encodeURIComponent(e)}&domainType=sogou`}function _e(e){return`http://webtrans.yodao.com/webTransPc/index.html#/?url=${encodeURIComponent(e)}&from=auto&to=auto&type=1`}Object(n.a)(Ae,((e,t)=>{var a;(null===(a=e.user)||void 0===a?void 0:a.vipActivated)?(qe=Object(n.a)(De,(e=>{Object.prototype.hasOwnProperty.call(e,"optionsSyncAt")||Ce()}),ne.a),browser.alarms.create(Ue,{periodInMinutes:60}),browser.alarms.onAlarm.addListener(Be),t&&We()):(qe&&qe(),browser.alarms.clear(Ue),browser.alarms.onAlarm.removeListener(Be))}));var He=a(298),Fe=a(400);const Ke=a.n(Fe)()({exact:!0,strict:!1});function Ve(e){return Ke.test(e)}const Ge=e=>`<match>${e.k}</match>  <dim>${e.v}</dim>`,Ye=e=>e?"翻译这段文本":"请输入想要翻译的文本或网址。",Je=["谷歌翻译","搜狗翻译","有道翻译"];let Qe;browser.omnibox.onInputStarted.addListener((()=>{browser.omnibox.setDefaultSuggestion({description:Ye("")})})),browser.omnibox.onInputChanged.addListener(((e,t)=>{const a=Object(He.a)();Qe=a,e?Ve(e)?(browser.omnibox.setDefaultSuggestion({description:"使用百度翻译此网址"}),t(Je.map((t=>({content:t+" "+e,description:`使用${t}此网址`}))))):async function(e){return(await w.a.post("https://fanyi.baidu.com/sug",{kw:e})).data.data||[]}(e).then((r=>{if(Qe===a){if(!r.length)return browser.omnibox.setDefaultSuggestion({description:Ye(e)}),void t([]);browser.omnibox.setDefaultSuggestion({description:Ge(r[0])}),t(r.slice(1).map((e=>({content:e.k,description:Ge(e)}))))}})):browser.omnibox.setDefaultSuggestion({description:Ye("")})})),browser.omnibox.onInputEntered.addListener((e=>{if(Ve(e))return void browser.tabs.create({url:(t=e,`https://fanyi.baidu.com/transpage?query=${encodeURIComponent(t)}&from=auto&to=zh&source=url&render=1`)});var t;const a=e.split(" ");if(2===a.length&&Je.includes(a[0])){const e=a[1];switch(a[0]){case"谷歌翻译":browser.tabs.create({url:Me(e)});break;case"搜狗翻译":browser.tabs.create({url:Ne(e)});break;case"有道翻译":browser.tabs.create({url:_e(e)})}}else M(e)}))},79:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i}));var r=a(105);let o,n=()=>{n=r.a,o=document.createElement("textarea"),o.style.position="absolute",o.style.top="-99999px",document.body.appendChild(o)};function s(e){return n(),o.value=e,o.select(),document.execCommand("copy")}function i(){return n(),o.value="",o.focus(),!!document.execCommand("paste")&&o.value}},98:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(90),o=a(3),n=a(177);class s{constructor(e,t){this.storageKey=e,this.max=t}async isOver(e){var t;const a=this.storageKey,s=Object(r.a)(o.b,["user",a]),i=await browser.storage.local.get(s);if(null===(t=i.user)||void 0===t?void 0:t.vipActivated)return!1;const c=i[a];let l=!1;const u=new Date;return c.date||(c.date=u.getTime()),Object(n.a)(u,c.date)?c.times>=this.max&&(l=!0):(c.date=u.getTime(),c.times=0),e&&!l&&(c.times+=1),await browser.storage.local.set({[a]:c}),l}async addOne(){const e=Object(r.a)(o.b,["user",this.storageKey]),t=(await browser.storage.local.get(e))[this.storageKey];t.times+=1,await browser.storage.local.set({[this.storageKey]:t})}}}});